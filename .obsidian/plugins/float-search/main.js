/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/floatSearchIndex.ts
var floatSearchIndex_exports = {};
__export(floatSearchIndex_exports, {
  default: () => FloatSearchPlugin
});
module.exports = __toCommonJS(floatSearchIndex_exports);
var import_obsidian2 = require("obsidian");

// src/leafView.ts
var import_obsidian = require("obsidian");
var popovers = /* @__PURE__ */ new WeakMap();
function isEmebeddedLeaf(leaf) {
  return leaf.containerEl.matches(".fs-block.fs-leaf-view .workspace-leaf");
}
function genId(size) {
  const chars = [];
  for (let n = 0; n < size; n++)
    chars.push((16 * Math.random() | 0).toString(16));
  return chars.join("");
}
function nosuper(base) {
  const derived = function() {
    return Object.setPrototypeOf(new import_obsidian.Component(), new.target.prototype);
  };
  derived.prototype = base.prototype;
  return Object.setPrototypeOf(derived, base);
}
var spawnLeafView = (plugin, initiatingEl, leaf, onShowCallback) => {
  let parent = app.workspace.activeLeaf;
  if (!parent)
    parent = leaf;
  if (!initiatingEl)
    initiatingEl = parent == null ? void 0 : parent.containerEl;
  const hoverPopover = new EmbeddedView(parent, initiatingEl, plugin, void 0, onShowCallback);
  return [hoverPopover.attachLeaf(), hoverPopover];
};
var _a, _b, _c, _d;
var EmbeddedView = class extends nosuper(import_obsidian.HoverPopover) {
  constructor(parent, targetEl, plugin, waitTime, onShowCallback) {
    super();
    this.targetEl = targetEl;
    this.plugin = plugin;
    this.onShowCallback = onShowCallback;
    this.abortController = this.addChild(new import_obsidian.Component());
    this.detaching = false;
    this.opening = false;
    this.rootSplit = new import_obsidian.WorkspaceSplit(window.app.workspace, "vertical");
    this.isPinned = true;
    this.oldPopover = (_a = this.parent) == null ? void 0 : _a.hoverPopover;
    this.document = (_d = (_c = (_b = this.targetEl) == null ? void 0 : _b.ownerDocument) != null ? _c : window.activeDocument) != null ? _d : window.document;
    this.id = genId(8);
    this.hoverEl = this.document.defaultView.createDiv({
      cls: "fs-block fs-leaf-view",
      attr: { id: "fs-" + this.id }
    });
    if (waitTime === void 0) {
      waitTime = 300;
    }
    this.onTarget = true;
    this.parent = parent;
    this.waitTime = waitTime;
    this.state = import_obsidian.PopoverState.Showing;
    const { hoverEl } = this;
    this.abortController.load();
    this.show();
    this.onShow();
    this.setActive = this._setActive.bind(this);
    popovers.set(this.hoverEl, this);
    this.hoverEl.addClass("fs-block");
    this.containerEl = this.hoverEl.createDiv("fs-content");
    this.buildWindowControls();
    this.setInitialDimensions();
  }
  static activeWindows() {
    const windows = [window];
    const { floatingSplit } = app.workspace;
    if (floatingSplit) {
      for (const split of floatingSplit.children) {
        if (split.win)
          windows.push(split.win);
      }
    }
    return windows;
  }
  static containerForDocument(doc) {
    if (doc !== document && app.workspace.floatingSplit)
      for (const container of app.workspace.floatingSplit.children) {
        if (container.doc === doc)
          return container;
      }
    return app.workspace.rootSplit;
  }
  static activePopovers() {
    return this.activeWindows().flatMap(this.popoversForWindow);
  }
  static popoversForWindow(win) {
    var _a2, _b2;
    return Array.prototype.slice.call((_b2 = (_a2 = win == null ? void 0 : win.document) == null ? void 0 : _a2.body.querySelectorAll(".fs-leaf-view")) != null ? _b2 : []).map((el) => popovers.get(el)).filter((he) => he);
  }
  static forLeaf(leaf) {
    const el = leaf && document.body.matchParent.call(leaf.containerEl, ".fs-leaf-view");
    return el ? popovers.get(el) : void 0;
  }
  static iteratePopoverLeaves(ws, cb) {
    for (const popover of this.activePopovers()) {
      if (popover.rootSplit && ws.iterateLeaves(cb, popover.rootSplit))
        return true;
    }
    return false;
  }
  _setActive(evt) {
    evt.preventDefault();
    evt.stopPropagation();
    this.plugin.app.workspace.setActiveLeaf(this.leaves()[0], { focus: true });
  }
  getDefaultMode() {
    return "source";
  }
  updateLeaves() {
    if (this.onTarget && this.targetEl && !this.document.contains(this.targetEl)) {
      this.onTarget = false;
      this.transition();
    }
    let leafCount = 0;
    this.plugin.app.workspace.iterateLeaves((leaf) => {
      leafCount++;
    }, this.rootSplit);
    if (leafCount === 0) {
      this.hide();
    }
    this.hoverEl.setAttribute("data-leaf-count", leafCount.toString());
  }
  leaves() {
    const leaves = [];
    this.plugin.app.workspace.iterateLeaves((leaf) => {
      leaves.push(leaf);
    }, this.rootSplit);
    return leaves;
  }
  setInitialDimensions() {
    this.hoverEl.style.height = "auto";
    this.hoverEl.style.width = "100%";
  }
  transition() {
    if (this.shouldShow()) {
      if (this.state === import_obsidian.PopoverState.Hiding) {
        this.state = import_obsidian.PopoverState.Shown;
        clearTimeout(this.timer);
      }
    } else {
      if (this.state === import_obsidian.PopoverState.Showing) {
        this.hide();
      } else {
        if (this.state === import_obsidian.PopoverState.Shown) {
          this.state = import_obsidian.PopoverState.Hiding;
          this.timer = window.setTimeout(() => {
            if (this.shouldShow()) {
              this.transition();
            } else {
              this.hide();
            }
          }, this.waitTime);
        }
      }
    }
  }
  buildWindowControls() {
    this.titleEl = this.document.defaultView.createDiv("popover-titlebar");
    this.titleEl.createDiv("popover-title");
    this.containerEl.prepend(this.titleEl);
  }
  attachLeaf() {
    this.rootSplit.getRoot = () => this.plugin.app.workspace[this.document === document ? "rootSplit" : "floatingSplit"];
    this.rootSplit.getContainer = () => EmbeddedView.containerForDocument(this.document);
    this.titleEl.insertAdjacentElement("afterend", this.rootSplit.containerEl);
    const leaf = this.plugin.app.workspace.createLeafInParent(this.rootSplit, 0);
    this.updateLeaves();
    return leaf;
  }
  onload() {
    super.onload();
    this.registerEvent(this.plugin.app.workspace.on("layout-change", this.updateLeaves, this));
    this.registerEvent(app.workspace.on("layout-change", () => {
      this.rootSplit.children.forEach((item, index) => {
        if (item instanceof import_obsidian.WorkspaceTabs) {
          this.rootSplit.replaceChild(index, item.children[0]);
        }
      });
    }));
  }
  onShow() {
    var _a2, _b2;
    const closeDelay = 600;
    setTimeout(() => this.waitTime = closeDelay, closeDelay);
    (_a2 = this.oldPopover) == null ? void 0 : _a2.hide();
    this.oldPopover = null;
    this.hoverEl.toggleClass("is-new", true);
    this.document.body.addEventListener("click", () => {
      this.hoverEl.toggleClass("is-new", false);
    }, { once: true, capture: true });
    if (this.parent) {
      this.parent.hoverPopover = this;
    }
    const viewHeaderEl = this.hoverEl.querySelector(".view-header");
    viewHeaderEl == null ? void 0 : viewHeaderEl.remove();
    const sizer = this.hoverEl.querySelector(".workspace-leaf");
    if (sizer)
      this.hoverEl.appendChild(sizer);
    const inlineTitle = this.hoverEl.querySelector(".inline-title");
    if (inlineTitle)
      inlineTitle.remove();
    (_b2 = this.onShowCallback) == null ? void 0 : _b2.call(this);
    this.onShowCallback = void 0;
  }
  detect(el) {
    const { targetEl } = this;
    if (targetEl) {
      this.onTarget = el === targetEl || targetEl.contains(el);
    }
  }
  shouldShow() {
    return this.shouldShowSelf() || this.shouldShowChild();
  }
  shouldShowChild() {
    return EmbeddedView.activePopovers().some((popover) => {
      if (popover !== this && popover.targetEl && this.hoverEl.contains(popover.targetEl)) {
        return popover.shouldShow();
      }
      return false;
    });
  }
  shouldShowSelf() {
    return !this.detaching && !!(this.onTarget || this.state == import_obsidian.PopoverState.Shown || this.document.querySelector(`body>.modal-container, body > #he${this.id} ~ .menu, body > #he${this.id} ~ .suggestion-container`));
  }
  show() {
    this.state = import_obsidian.PopoverState.Shown;
    this.timer = 0;
    this.targetEl.appendChild(this.hoverEl);
    this.onShow();
    app.workspace.onLayoutChange();
    this.load();
    if (this.hoverEl.dataset.imgHeight && this.hoverEl.dataset.imgWidth) {
      this.hoverEl.style.height = parseFloat(this.hoverEl.dataset.imgHeight) + this.titleEl.offsetHeight + "px";
      this.hoverEl.style.width = parseFloat(this.hoverEl.dataset.imgWidth) + "px";
    }
  }
  onHide() {
    var _a2;
    this.oldPopover = null;
    if (((_a2 = this.parent) == null ? void 0 : _a2.hoverPopover) === this) {
      this.parent.hoverPopover = null;
    }
  }
  hide() {
    var _a2;
    this.onTarget = false;
    this.detaching = true;
    if (this.timer) {
      clearTimeout(this.timer);
      this.timer = 0;
    }
    this.hoverEl.hide();
    if (this.opening)
      return;
    const leaves = this.leaves();
    if (leaves.length) {
      this.targetEl.empty();
    } else {
      this.parent = null;
      (_a2 = this.abortController) == null ? void 0 : _a2.unload();
      this.abortController = void 0;
      return this.nativeHide();
    }
  }
  nativeHide() {
    var _a2;
    const { hoverEl, targetEl } = this;
    this.state = import_obsidian.PopoverState.Hidden;
    hoverEl.detach();
    if (targetEl) {
      const parent = targetEl.matchParent(".fs-leaf-view");
      if (parent)
        (_a2 = popovers.get(parent)) == null ? void 0 : _a2.transition();
    }
    this.onHide();
    this.unload();
  }
  resolveLink(linkText, sourcePath) {
    const link = (0, import_obsidian.parseLinktext)(linkText);
    const tFile = link ? this.plugin.app.metadataCache.getFirstLinkpathDest(link.path, sourcePath) : null;
    return tFile;
  }
  async openLink(linkText, sourcePath, eState, createInLeaf) {
    var _a2, _b2, _c2;
    let file = this.resolveLink(linkText, sourcePath);
    const link = (0, import_obsidian.parseLinktext)(linkText);
    if (!file && createInLeaf) {
      const folder = this.plugin.app.fileManager.getNewFileParent(sourcePath);
      file = await this.plugin.app.fileManager.createNewMarkdownFile(folder, link.path);
    }
    if (!file) {
      return;
    }
    const { viewRegistry } = this.plugin.app;
    const viewType = viewRegistry.typeByExtension[file.extension];
    if (!viewType || !viewRegistry.viewByType[viewType]) {
      return;
    }
    eState = Object.assign(this.buildEphemeralState(file, link), eState);
    const parentMode = this.getDefaultMode();
    const state = this.buildState(parentMode, eState);
    const leaf = await this.openFile(file, state, createInLeaf);
    const leafViewType = (_a2 = leaf == null ? void 0 : leaf.view) == null ? void 0 : _a2.getViewType();
    if (leafViewType === "image") {
      if (((_b2 = this.parent) == null ? void 0 : _b2.hasOwnProperty("editorEl")) && this.parent.editorEl.hasClass("is-live-preview")) {
        this.waitTime = 3e3;
      }
      const img = leaf.view.contentEl.querySelector("img");
      this.hoverEl.dataset.imgHeight = String(img.naturalHeight);
      this.hoverEl.dataset.imgWidth = String(img.naturalWidth);
      this.hoverEl.dataset.imgRatio = String(img.naturalWidth / img.naturalHeight);
    } else if (leafViewType === "pdf") {
      this.hoverEl.style.height = "800px";
      this.hoverEl.style.width = "600px";
    }
    if (((_c2 = state.state) == null ? void 0 : _c2.mode) === "source") {
      this.whenShown(() => {
        var _a3, _b3, _c3, _d2;
        if ((0, import_obsidian.requireApiVersion)("1.0"))
          (_c3 = (_b3 = (_a3 = leaf == null ? void 0 : leaf.view) == null ? void 0 : _a3.editMode) == null ? void 0 : _b3.reinit) == null ? void 0 : _c3.call(_b3);
        (_d2 = leaf == null ? void 0 : leaf.view) == null ? void 0 : _d2.setEphemeralState(state.eState);
      });
    }
  }
  whenShown(callback) {
    if (this.detaching)
      return;
    const existingCallback = this.onShowCallback;
    this.onShowCallback = () => {
      if (this.detaching)
        return;
      callback();
      if (typeof existingCallback === "function")
        existingCallback();
    };
    if (this.state === import_obsidian.PopoverState.Shown) {
      this.onShowCallback();
      this.onShowCallback = void 0;
    }
  }
  async openFile(file, openState, useLeaf) {
    if (this.detaching)
      return;
    const leaf = useLeaf != null ? useLeaf : this.attachLeaf();
    this.opening = true;
    try {
      await leaf.openFile(file, openState);
    } catch (e) {
      console.error(e);
    } finally {
      this.opening = false;
      if (this.detaching)
        this.hide();
    }
    this.plugin.app.workspace.setActiveLeaf(leaf);
    return leaf;
  }
  buildState(parentMode, eState) {
    return {
      active: false,
      state: { mode: "source" },
      eState
    };
  }
  buildEphemeralState(file, link) {
    const cache = this.plugin.app.metadataCache.getFileCache(file);
    const subpath = cache ? (0, import_obsidian.resolveSubpath)(cache, (link == null ? void 0 : link.subpath) || "") : void 0;
    const eState = { subpath: link == null ? void 0 : link.subpath };
    if (subpath) {
      eState.line = subpath.start.line;
      eState.startLoc = subpath.start;
      eState.endLoc = subpath.end || void 0;
    }
    return eState;
  }
};

// node_modules/.pnpm/monkey-around@2.3.0/node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/floatSearchIndex.ts
var FloatSearchPlugin = class extends import_obsidian2.Plugin {
  constructor() {
    super(...arguments);
    this.applyDebounceTimer = 0;
  }
  applySettingsUpdate() {
    clearTimeout(this.applyDebounceTimer);
    this.applyDebounceTimer = window.setTimeout(() => {
      this.state = {
        ...this.state,
        query: ""
      };
    }, 3e4);
  }
  async onload() {
    this.patchWorkspace();
    this.patchWorkspaceLeaf();
    this.registerObsidianURIHandler();
    this.registerObsidianCommands();
    this.registerEditorMenuHandler();
    this.registerContextMenuHandler();
    this.addRibbonIcon("search", "Search Obsidian In Modal", () => {
      this.modal = new FloatSearchModal((state) => {
        this.state = state;
        this.applySettingsUpdate();
      }, this.app, this, this.state);
      this.modal.open();
    });
  }
  onunload() {
    this.state = void 0;
  }
  patchWorkspace() {
    let layoutChanging = false;
    const uninstaller = around(import_obsidian2.Workspace.prototype, {
      getLeaf: (next) => function(...args) {
        const activeLeaf = this.activeLeaf;
        if (activeLeaf) {
          const fsCtnEl = activeLeaf.parent.containerEl.parentElement;
          if (fsCtnEl == null ? void 0 : fsCtnEl.classList.contains("fs-content")) {
            if (activeLeaf.view.getViewType() === "markdown") {
              return activeLeaf;
            }
            const newLeaf = app.workspace.getUnpinnedLeaf();
            if (newLeaf) {
              this.setActiveLeaf(newLeaf);
            }
          }
          return next.call(this, ...args);
        }
        return next.call(this, ...args);
      },
      changeLayout(old) {
        return async function(workspace) {
          layoutChanging = true;
          try {
            await old.call(this, workspace);
          } finally {
            layoutChanging = false;
          }
        };
      },
      iterateLeaves(old) {
        return function(arg1, arg2) {
          if (old.call(this, arg1, arg2))
            return true;
          const cb = typeof arg1 === "function" ? arg1 : arg2;
          const parent = typeof arg1 === "function" ? arg2 : arg1;
          if (!parent)
            return false;
          if (layoutChanging)
            return false;
          if (parent === app.workspace.rootSplit || import_obsidian2.WorkspaceContainer && parent instanceof import_obsidian2.WorkspaceContainer) {
            for (const popover of EmbeddedView.popoversForWindow(parent.win)) {
              if (old.call(this, cb, popover.rootSplit))
                return true;
            }
          }
          return false;
        };
      },
      onDragLeaf(old) {
        return function(event, leaf) {
          return old.call(this, event, leaf);
        };
      }
    });
    this.register(uninstaller);
  }
  patchWorkspaceLeaf() {
    this.register(around(import_obsidian2.WorkspaceLeaf.prototype, {
      getRoot(old) {
        return function() {
          const top = old.call(this);
          return (top == null ? void 0 : top.getRoot) === this.getRoot ? top : top == null ? void 0 : top.getRoot();
        };
      },
      setPinned(old) {
        return function(pinned) {
          old.call(this, pinned);
          if (isEmebeddedLeaf(this) && !pinned)
            this.setPinned(true);
        };
      },
      openFile(old) {
        return function(file, openState) {
          if (isEmebeddedLeaf(this)) {
            setTimeout(around(import_obsidian2.Workspace.prototype, {
              recordMostRecentOpenedFile(old2) {
                return function(_file) {
                  if (_file !== file) {
                    return old2.call(this, _file);
                  }
                };
              }
            }), 1);
            const recentFiles = this.app.plugins.plugins["recent-files-obsidian"];
            if (recentFiles) {
              setTimeout(around(recentFiles, {
                shouldAddFile(old2) {
                  return function(_file) {
                    return _file !== file && old2.call(this, _file);
                  };
                }
              }), 1);
            }
          }
          const view = old.call(this, file, openState);
          setTimeout(() => {
            const fsCtnEl = this.parent.containerEl.parentElement;
            if (!(fsCtnEl == null ? void 0 : fsCtnEl.classList.contains("fs-content")))
              return;
            if (file.extension != "canvas")
              return;
            const canvas = this.view.canvas;
            setTimeout(() => {
              var _a2, _b2;
              if (canvas && ((_a2 = openState == null ? void 0 : openState.eState) == null ? void 0 : _a2.match)) {
                let node = (_b2 = canvas.data.nodes) == null ? void 0 : _b2.find((e) => e.text === openState.eState.match.content);
                node = canvas.nodes.get(node.id);
                canvas.selectOnly(node);
                canvas.zoomToSelection();
              }
            }, 20);
          }, 1);
          return view;
        };
      }
    }));
  }
  registerObsidianURIHandler() {
    this.registerObsidianProtocolHandler("fs", (path) => {
      this.modal = new FloatSearchModal((state) => {
        this.state = state;
        this.applySettingsUpdate();
      }, this.app, this, { query: path.query, current: false });
      this.modal.open();
    });
  }
  registerObsidianCommands() {
    this.addCommand({
      id: "search-obsidian-globally",
      name: "Search Obsidian Globally",
      callback: () => {
        this.modal = new FloatSearchModal((state) => {
          this.state = state;
        }, this.app, this, { ...this.state, query: "", current: false });
        this.modal.open();
      }
    });
    this.addCommand({
      id: "search-obsidian-globally-state",
      name: "Search Obsidian Globally (With Last State)",
      callback: () => {
        this.modal = new FloatSearchModal((state) => {
          this.state = state;
        }, this.app, this, { ...this.state, current: false });
        this.modal.open();
      }
    });
    this.addCommand({
      id: "search-in-backlink",
      name: "Search In Backlink Of Current File",
      checkCallback: (checking) => {
        const activeLeaf = this.app.workspace.activeLeaf;
        if (!activeLeaf)
          return;
        const viewType = activeLeaf.view.getViewType();
        if (viewType === "markdown" || viewType === "canvas") {
          if (!checking) {
            const currentFile = activeLeaf.view.file;
            this.modal = new FloatSearchModal((state) => {
              this.state = state;
              this.applySettingsUpdate();
            }, this.app, this, { ...this.state, query: " /\\[\\[" + (currentFile.extension === "canvas" ? currentFile.name : currentFile.basename) + "(\\|[^\\]]*)?\\]\\]/", current: true });
            this.modal.open();
          }
          return true;
        }
      }
    });
    this.addCommand({
      id: "search-in-current-file",
      name: "Search In Current File",
      checkCallback: (checking) => {
        const activeLeaf = this.app.workspace.activeLeaf;
        if (!activeLeaf)
          return;
        const viewType = activeLeaf.view.getViewType();
        if (viewType === "markdown" || viewType === "canvas") {
          if (!checking) {
            const currentFile = activeLeaf.view.file;
            this.modal = new FloatSearchModal((state) => {
              this.state = state;
              this.applySettingsUpdate();
            }, this.app, this, { ...this.state, query: " path:" + currentFile.path, current: true });
            this.modal.open();
          }
          return true;
        }
      }
    });
    this.addCommand({
      id: "open-search-view",
      name: "Open Search View",
      callback: async () => {
        const leaf = app.workspace.getLeaf();
        leaf.setPinned(true);
        await leaf.setViewState({
          type: "search"
        });
      }
    });
  }
  registerEditorMenuHandler() {
    this.registerEvent(this.app.workspace.on("editor-menu", (menu, editor, view) => {
      if (!editor) {
        return;
      }
      if (editor.getSelection().length === 0) {
        return;
      }
      const selection = editor.getSelection().trim();
      let searchWord = selection;
      if (selection.length > 8) {
        searchWord = selection.substring(0, 3) + "..." + selection.substring(selection.length - 3, selection.length);
      } else {
        searchWord = selection;
      }
      menu.addItem((item) => {
        item.setTitle('Search "' + searchWord + '" in Float Search').setIcon("search").onClick(() => {
          this.modal = new FloatSearchModal((state) => {
            this.state = state;
            this.applySettingsUpdate();
          }, this.app, this, { query: selection, current: false });
          this.modal.open();
        });
      });
    }));
  }
  registerContextMenuHandler() {
    this.registerEvent(this.app.workspace.on("file-menu", (menu, file, source, leaf) => {
      const popover = leaf ? EmbeddedView.forLeaf(leaf) : void 0;
      if (file instanceof import_obsidian2.TFile && !popover && !leaf) {
        menu.addItem((item) => {
          var _a2, _b2;
          (_b2 = (_a2 = item.setIcon("popup-open").setTitle("Open in Float Preview").onClick(async () => {
            if (this.modal) {
              await this.modal.initFileView(file, void 0);
              return;
            }
            this.modal = new FloatSearchModal((state) => {
              this.state = state;
              this.applySettingsUpdate();
            }, this.app, this, { query: "", current: false });
            this.modal.open();
            setTimeout(async () => {
              await this.modal.initFileView(file, void 0);
            }, 20);
          })).setSection) == null ? void 0 : _b2.call(_a2, "open");
        });
      }
    }));
  }
};
var FloatSearchModal = class extends import_obsidian2.Modal {
  constructor(cb, app2, plugin, state, viewType = "search") {
    super(app2);
    this.plugin = plugin;
    this.cb = cb;
    this.state = state;
    this.viewType = viewType;
  }
  async onOpen() {
    const { contentEl, containerEl, modalEl } = this;
    this.searchCtnEl = contentEl.createDiv({ cls: "float-search-modal-search-ctn" });
    this.instructionsEl = modalEl.createDiv({ cls: "float-search-modal-instructions" });
    this.initInstructions(this.instructionsEl);
    this.initCss(contentEl, modalEl, containerEl);
    await this.initSearchView(this.searchCtnEl, this.viewType);
    this.initInput();
    this.initContent();
  }
  onClose() {
    var _a2, _b2;
    const { contentEl } = this;
    this.cb(this.searchLeaf.view.getState());
    this.searchLeaf.detach();
    (_a2 = this.fileLeaf) == null ? void 0 : _a2.detach();
    this.searchEmbeddedView.unload();
    (_b2 = this.fileEmbeddedView) == null ? void 0 : _b2.unload();
    contentEl.empty();
  }
  initInstructions(instructionsEl) {
    const navigateInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-navigate" });
    const collapseInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-collapse" });
    const enterInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-enter" });
    const altEnterInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-alt-enter" });
    const tabInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-tab" });
    const switchInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-switch" });
    const navigateIconEl = navigateInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const navigateTextEl = navigateInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    navigateIconEl.setText("\u2191\u2193");
    navigateTextEl.setText("Navigate");
    const collapseIconEl = collapseInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const collapseTextEl = collapseInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    collapseIconEl.setText("Shift+\u2191\u2193");
    collapseTextEl.setText("Collapse/Expand");
    const enterIconEl = enterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const enterTextEl = enterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    enterIconEl.setText("\u21B5");
    enterTextEl.setText("Open in background");
    const altEnterIconEl = altEnterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const altEnterTextEl = altEnterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    altEnterIconEl.setText("Alt+\u21B5");
    altEnterTextEl.setText("Open File and Close");
    const tabIconEl = tabInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const tabTextEl = tabInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    tabIconEl.setText("Tab/Shift+Tab");
    tabTextEl.setText("Preview/Close Preview");
    const switchIconEl = switchInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const switchTextEl = switchInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    switchIconEl.setText("Ctrl+G");
    switchTextEl.setText("Switch Between Search and File View");
    const clickInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-click" });
    const clickIconEl = clickInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const clickTextEl = clickInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    clickIconEl.setText("Alt+Click");
    clickTextEl.setText("Close Modal While In File View");
  }
  initCss(contentEl, modalEl, containerEl) {
    contentEl.classList.add("float-search-modal-content");
    modalEl.classList.add("float-search-modal");
    containerEl.classList.add("float-search-modal-container");
  }
  async initSearchView(contentEl, viewType) {
    const [createdLeaf, embeddedView] = spawnLeafView(this.plugin, contentEl);
    this.searchLeaf = createdLeaf;
    this.searchEmbeddedView = embeddedView;
    this.searchLeaf.setPinned(true);
    await this.searchLeaf.setViewState({
      type: "search"
    });
    setTimeout(async () => {
      var _a2, _b2, _c2, _d2, _e;
      await this.searchLeaf.view.setState(this.state, true);
      ((_a2 = this.state) == null ? void 0 : _a2.current) ? this.searchLeaf.view.searchComponent.inputEl.setSelectionRange(0, 0) : this.searchLeaf.view.searchComponent.inputEl.setSelectionRange((_c2 = (_b2 = this.state) == null ? void 0 : _b2.query) == null ? void 0 : _c2.length, (_e = (_d2 = this.state) == null ? void 0 : _d2.query) == null ? void 0 : _e.length);
    }, 0);
    return;
  }
  initInput() {
    const inputEl = this.contentEl.getElementsByTagName("input")[0];
    inputEl.focus();
    inputEl.onkeydown = (e) => {
      var _a2, _b2;
      const currentView = this.searchLeaf.view;
      switch (e.key) {
        case "ArrowDown":
          if (e.shiftKey) {
            currentView.onKeyShowMoreAfter(e);
            if (currentView.dom.focusedItem) {
              if (currentView.dom.focusedItem.collapsible) {
                currentView.dom.focusedItem.setCollapse(false);
              }
            }
            break;
          } else {
            currentView.onKeyArrowDownInFocus(e);
            break;
          }
        case "ArrowUp":
          if (e.shiftKey) {
            currentView.onKeyShowMoreBefore(e);
            if (currentView.dom.focusedItem) {
              if (currentView.dom.focusedItem.collapseEl) {
                currentView.dom.focusedItem.setCollapse(true);
              }
            }
            break;
          } else {
            currentView.onKeyArrowUpInFocus(e);
            break;
          }
        case "ArrowLeft":
          currentView.onKeyArrowLeftInFocus(e);
          break;
        case "ArrowRight":
          currentView.onKeyArrowRightInFocus(e);
          break;
        case "Enter":
          currentView.onKeyEnterInFocus(e);
          if (e.altKey && currentView.dom.focusedItem) {
            this.close();
          }
          break;
        case "Tab":
          e.preventDefault();
          if (e.shiftKey) {
            if (this.fileLeaf) {
              (_a2 = this.fileLeaf) == null ? void 0 : _a2.detach();
              this.fileLeaf = void 0;
              (_b2 = this.fileEmbeddedView) == null ? void 0 : _b2.unload();
              this.modalEl.toggleClass("float-search-width", false);
              this.fileEl.detach();
              break;
            }
          }
          if (currentView.dom.focusedItem) {
            const item = currentView.dom.focusedItem;
            const file = item.parent.file instanceof import_obsidian2.TFile ? item.parent.file : item.file;
            item.parent.file instanceof import_obsidian2.TFile ? this.initFileView(file, { match: {
              content: item.content,
              matches: item.matches
            } }) : this.initFileView(file, void 0);
          }
          break;
        case "e":
          if (e.ctrlKey) {
            e.preventDefault();
            if (this.fileLeaf) {
              const estate = this.fileLeaf.getViewState();
              estate.state.mode = estate.state.mode === "preview" ? "source" : "preview";
              this.fileLeaf.setViewState(estate, {
                focus: true
              });
              setTimeout(() => {
                this.searchLeaf.view.searchComponent.inputEl.focus();
              }, 0);
            }
            break;
          }
        case "g":
          if (this.fileLeaf && e.ctrlKey) {
            e.preventDefault();
            app.workspace.setActiveLeaf(this.fileLeaf, {
              focus: true
            });
          }
          break;
        case "C":
          if (e.ctrlKey && e.shiftKey) {
            e.preventDefault();
            const text = currentView.dom.focusedItem.el.innerText;
            navigator.clipboard.writeText(text);
          }
      }
    };
  }
  initContent() {
    const { contentEl } = this;
    contentEl.onclick = (e) => {
      const resultElement = contentEl.getElementsByClassName("search-results-children")[0];
      if (resultElement.children.length < 2) {
        return;
      }
      let targetElement = e.target;
      if (e.altKey || !this.fileLeaf) {
        while (targetElement) {
          if (targetElement.classList.contains("tree-item")) {
            this.close();
            break;
          }
          targetElement = targetElement.parentElement;
        }
        return;
      }
      if (this.fileLeaf) {
        const currentView = this.searchLeaf.view;
        if (this.searchCtnEl.contains(targetElement)) {
          while (targetElement) {
            if (targetElement.classList.contains("tree-item")) {
              break;
            }
            targetElement = targetElement.parentElement;
          }
          if (!targetElement)
            return;
          const fileInnerEl = targetElement == null ? void 0 : targetElement.getElementsByClassName("tree-item-inner")[0];
          const innerText = fileInnerEl.innerText;
          const file = app.metadataCache.getFirstLinkpathDest(innerText, "");
          if (file) {
            const item = currentView.dom.resultDomLookup.get(file);
            currentView.dom.setFocusedItem(item);
            this.initFileView(file, void 0);
            this.searchLeaf.view.searchComponent.inputEl.focus();
          }
        }
        return;
      }
    };
  }
  async initFileView(file, state) {
    var _a2, _b2, _c2;
    if (this.fileLeaf) {
      await this.fileLeaf.openFile(file, {
        active: false,
        eState: state
      });
      if (((_b2 = (_a2 = this.fileState) == null ? void 0 : _a2.match) == null ? void 0 : _b2.matches[0]) === ((_c2 = state == null ? void 0 : state.match) == null ? void 0 : _c2.matches[0]) && state && this.fileState) {
        setTimeout(() => {
          if (this.fileLeaf) {
            app.workspace.setActiveLeaf(this.fileLeaf, {
              focus: true
            });
          }
        }, 0);
      } else {
        this.fileState = state;
        setTimeout(() => {
          this.searchLeaf.view.searchComponent.inputEl.focus();
        }, 0);
      }
      return;
    }
    const { contentEl } = this;
    this.fileEl = contentEl.createDiv({ cls: "float-search-modal-file-ctn" });
    this.modalEl.toggleClass("float-search-width", true);
    this.fileEl.onkeydown = (e) => {
      if (e.ctrlKey && e.key === "g") {
        e.preventDefault();
        e.stopPropagation();
        this.searchLeaf.view.searchComponent.inputEl.focus();
      }
      if (e.key === "Tab" && e.ctrlKey) {
        e.preventDefault();
        e.stopPropagation();
        this.searchLeaf.view.searchComponent.inputEl.focus();
      }
    };
    if (!this.fileEl)
      return;
    const [createdLeaf, embeddedView] = spawnLeafView(this.plugin, this.fileEl);
    this.fileLeaf = createdLeaf;
    this.fileEmbeddedView = embeddedView;
    this.fileLeaf.setPinned(true);
    await this.fileLeaf.openFile(file, {
      active: false,
      eState: state
    });
    this.fileState = state;
    this.searchLeaf.view.searchComponent.inputEl.focus();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL2Zsb2F0U2VhcmNoSW5kZXgudHMiLCAic3JjL2xlYWZWaWV3LnRzIiwgIm5vZGVfbW9kdWxlcy8ucG5wbS9tb25rZXktYXJvdW5kQDIuMy4wL25vZGVfbW9kdWxlcy9tb25rZXktYXJvdW5kL21qcy9pbmRleC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcblx0QXBwLFxuXHRFZGl0b3IsXG5cdE1hcmtkb3duVmlldyxcblx0TWVudSxcblx0TW9kYWwsIE5vdGljZSwgT3BlblZpZXdTdGF0ZSxcblx0UGx1Z2luLCBTZWFyY2hWaWV3LFxuXHRUQWJzdHJhY3RGaWxlLFxuXHRURmlsZSxcblx0V29ya3NwYWNlLFxuXHRXb3Jrc3BhY2VDb250YWluZXIsIFdvcmtzcGFjZUl0ZW0sXG5cdFdvcmtzcGFjZUxlYWZcbn0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRW1iZWRkZWRWaWV3LCBpc0VtZWJlZGRlZExlYWYsIHNwYXduTGVhZlZpZXcgfSBmcm9tIFwiLi9sZWFmVmlld1wiO1xuaW1wb3J0IHsgYXJvdW5kIH0gZnJvbSBcIm1vbmtleS1hcm91bmRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmxvYXRTZWFyY2hQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRwcml2YXRlIHN0YXRlOiBhbnk7XG5cdHByaXZhdGUgYXBwbHlEZWJvdW5jZVRpbWVyID0gMDtcblx0cHJpdmF0ZSBtb2RhbDogRmxvYXRTZWFyY2hNb2RhbDtcblxuXHRwdWJsaWMgYXBwbHlTZXR0aW5nc1VwZGF0ZSgpIHtcblx0XHRjbGVhclRpbWVvdXQodGhpcy5hcHBseURlYm91bmNlVGltZXIpO1xuXHRcdHRoaXMuYXBwbHlEZWJvdW5jZVRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5zdGF0ZSA9IHtcblx0XHRcdFx0Li4udGhpcy5zdGF0ZSxcblx0XHRcdFx0cXVlcnk6IFwiXCIsXG5cdFx0XHR9O1xuXHRcdH0sIDMwMDAwKTtcblx0fVxuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHR0aGlzLnBhdGNoV29ya3NwYWNlKCk7XG5cdFx0dGhpcy5wYXRjaFdvcmtzcGFjZUxlYWYoKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJPYnNpZGlhblVSSUhhbmRsZXIoKTtcblx0XHR0aGlzLnJlZ2lzdGVyT2JzaWRpYW5Db21tYW5kcygpO1xuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JNZW51SGFuZGxlcigpO1xuXHRcdHRoaXMucmVnaXN0ZXJDb250ZXh0TWVudUhhbmRsZXIoKTtcblxuXHRcdHRoaXMuYWRkUmliYm9uSWNvbignc2VhcmNoJywgJ1NlYXJjaCBPYnNpZGlhbiBJbiBNb2RhbCcsICgpID0+IHtcblx0XHRcdHRoaXMubW9kYWwgPSBuZXcgRmxvYXRTZWFyY2hNb2RhbCgoc3RhdGUpPT57XG5cdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcblx0XHRcdFx0dGhpcy5hcHBseVNldHRpbmdzVXBkYXRlKCk7XG5cdFx0XHR9LHRoaXMuYXBwLCB0aGlzLCB0aGlzLnN0YXRlKTtcblx0XHRcdHRoaXMubW9kYWwub3BlbigpO1xuXHRcdH0pO1xuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cdFx0dGhpcy5zdGF0ZSA9IHVuZGVmaW5lZDtcblx0fVxuXG5cdHBhdGNoV29ya3NwYWNlKCkge1xuXHRcdGxldCBsYXlvdXRDaGFuZ2luZyA9IGZhbHNlO1xuXHRcdGNvbnN0IHVuaW5zdGFsbGVyID0gYXJvdW5kKFdvcmtzcGFjZS5wcm90b3R5cGUsIHtcblx0XHRcdGdldExlYWY6IChuZXh0KSA9PlxuXHRcdFx0XHRmdW5jdGlvbiAoLi4uYXJncykge1xuXHRcdFx0XHRcdGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFjdGl2ZUxlYWY7XG5cdFx0XHRcdFx0aWYoYWN0aXZlTGVhZikge1xuXHRcdFx0XHRcdFx0Y29uc3QgZnNDdG5FbCA9IChhY3RpdmVMZWFmLnBhcmVudC5jb250YWluZXJFbCBhcyBIVE1MRWxlbWVudCkucGFyZW50RWxlbWVudDtcblx0XHRcdFx0XHRcdGlmKGZzQ3RuRWw/LmNsYXNzTGlzdC5jb250YWlucyhcImZzLWNvbnRlbnRcIikpIHtcblx0XHRcdFx0XHRcdFx0aWYoYWN0aXZlTGVhZi52aWV3LmdldFZpZXdUeXBlKCkgPT09IFwibWFya2Rvd25cIikge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBhY3RpdmVMZWFmO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGNvbnN0IG5ld0xlYWYgPSBhcHAud29ya3NwYWNlLmdldFVucGlubmVkTGVhZigpO1xuXHRcdFx0XHRcdFx0XHRpZihuZXdMZWFmKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5zZXRBY3RpdmVMZWFmKG5ld0xlYWYpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRyZXR1cm4gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xuXHRcdFx0fSxcblx0XHRcdGNoYW5nZUxheW91dChvbGQpIHtcblx0XHRcdFx0cmV0dXJuIGFzeW5jIGZ1bmN0aW9uICh3b3Jrc3BhY2U6IHVua25vd24pIHtcblx0XHRcdFx0XHRsYXlvdXRDaGFuZ2luZyA9IHRydWU7XG5cdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdC8vIERvbid0IGNvbnNpZGVyIGhvdmVyIHBvcG92ZXJzIHBhcnQgb2YgdGhlIHdvcmtzcGFjZSB3aGlsZSBpdCdzIGNoYW5naW5nXG5cdFx0XHRcdFx0XHRhd2FpdCBvbGQuY2FsbCh0aGlzLCB3b3Jrc3BhY2UpO1xuXHRcdFx0XHRcdH0gZmluYWxseSB7XG5cdFx0XHRcdFx0XHRsYXlvdXRDaGFuZ2luZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblx0XHRcdH0sXG5cdFx0XHRpdGVyYXRlTGVhdmVzKG9sZCkge1xuXHRcdFx0XHR0eXBlIGxlYWZJdGVyYXRvciA9IChpdGVtOiBXb3Jrc3BhY2VMZWFmKSA9PiBib29sZWFuIHwgdm9pZDtcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uIChhcmcxLCBhcmcyKSB7XG5cdFx0XHRcdFx0Ly8gRmFzdCBleGl0IGlmIGRlc2lyZWQgbGVhZiBmb3VuZFxuXHRcdFx0XHRcdGlmIChvbGQuY2FsbCh0aGlzLCBhcmcxLCBhcmcyKSkgcmV0dXJuIHRydWU7XG5cblx0XHRcdFx0XHQvLyBIYW5kbGUgb2xkL25ldyBBUEkgcGFyYW1ldGVyIHN3YXBcblx0XHRcdFx0XHRjb25zdCBjYjogICAgIGxlYWZJdGVyYXRvciAgPSAodHlwZW9mIGFyZzEgPT09IFwiZnVuY3Rpb25cIiA/IGFyZzEgOiBhcmcyKSBhcyBsZWFmSXRlcmF0b3I7XG5cdFx0XHRcdFx0Y29uc3QgcGFyZW50OiBXb3Jrc3BhY2VJdGVtID0gKHR5cGVvZiBhcmcxID09PSBcImZ1bmN0aW9uXCIgPyBhcmcyIDogYXJnMSkgYXMgV29ya3NwYWNlSXRlbTtcblxuXHRcdFx0XHRcdGlmICghcGFyZW50KSByZXR1cm4gZmFsc2U7ICAvLyA8LSBkdXJpbmcgYXBwIHN0YXJ0dXAsIHJvb3RTcGxpdCBjYW4gYmUgbnVsbFxuXHRcdFx0XHRcdGlmIChsYXlvdXRDaGFuZ2luZykgcmV0dXJuIGZhbHNlOyAgLy8gRG9uJ3QgbGV0IEhFcyBjbG9zZSBkdXJpbmcgd29ya3NwYWNlIGNoYW5nZVxuXG5cdFx0XHRcdFx0Ly8gMC4xNC54IGRvZXNuJ3QgaGF2ZSBXb3Jrc3BhY2VDb250YWluZXI7IHRoaXMgY2FuIGp1c3QgYmUgYW4gaW5zdGFuY2VvZiBjaGVjayBvbmNlIDE1LnggaXMgbWFuZGF0b3J5OlxuXHRcdFx0XHRcdGlmIChwYXJlbnQgPT09IGFwcC53b3Jrc3BhY2Uucm9vdFNwbGl0IHx8IChXb3Jrc3BhY2VDb250YWluZXIgJiYgcGFyZW50IGluc3RhbmNlb2YgV29ya3NwYWNlQ29udGFpbmVyKSkge1xuXHRcdFx0XHRcdFx0Zm9yKGNvbnN0IHBvcG92ZXIgb2YgRW1iZWRkZWRWaWV3LnBvcG92ZXJzRm9yV2luZG93KChwYXJlbnQgYXMgV29ya3NwYWNlQ29udGFpbmVyKS53aW4pKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFVzZSBvbGQgQVBJIGhlcmUgZm9yIGNvbXBhdCB3LzAuMTQueFxuXHRcdFx0XHRcdFx0XHRpZiAob2xkLmNhbGwodGhpcywgY2IsIHBvcG92ZXIucm9vdFNwbGl0KSkgcmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fTtcblx0XHRcdH0sXG5cdFx0XHRvbkRyYWdMZWFmKG9sZCkge1xuXHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKGV2ZW50OiBNb3VzZUV2ZW50LCBsZWFmOiBXb3Jrc3BhY2VMZWFmKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9sZC5jYWxsKHRoaXMsIGV2ZW50LCBsZWFmKTtcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHR0aGlzLnJlZ2lzdGVyKHVuaW5zdGFsbGVyKTtcblx0fVxuXG5cdC8vIFVzZWQgZm9yIHBhdGNoIHdvcmtzcGFjZWxlYWYgcGlubmVkIGJlaGF2aW9yc1xuXHRwYXRjaFdvcmtzcGFjZUxlYWYoKSB7XG5cdFx0dGhpcy5yZWdpc3Rlcihcblx0XHRcdGFyb3VuZChXb3Jrc3BhY2VMZWFmLnByb3RvdHlwZSwge1xuXHRcdFx0XHRnZXRSb290KG9sZCkge1xuXHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRjb25zdCB0b3AgPSBvbGQuY2FsbCh0aGlzKTtcblx0XHRcdFx0XHRcdHJldHVybiB0b3A/LmdldFJvb3QgPT09IHRoaXMuZ2V0Um9vdCA/IHRvcCA6IHRvcD8uZ2V0Um9vdCgpO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNldFBpbm5lZChvbGQpIHtcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKHBpbm5lZDogYm9vbGVhbikge1xuXHRcdFx0XHRcdFx0b2xkLmNhbGwodGhpcywgcGlubmVkKTtcblx0XHRcdFx0XHRcdGlmKGlzRW1lYmVkZGVkTGVhZih0aGlzKSAmJiAhcGlubmVkKSB0aGlzLnNldFBpbm5lZCh0cnVlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9wZW5GaWxlKG9sZCkge1xuXHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbiAoZmlsZTogVEZpbGUsIG9wZW5TdGF0ZT86IE9wZW5WaWV3U3RhdGUpIHtcblx0XHRcdFx0XHRcdGlmIChpc0VtZWJlZGRlZExlYWYodGhpcykpIHtcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChcblx0XHRcdFx0XHRcdFx0XHRhcm91bmQoV29ya3NwYWNlLnByb3RvdHlwZSwge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmVjb3JkTW9zdFJlY2VudE9wZW5lZEZpbGUob2xkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbiAoX2ZpbGU6IFRGaWxlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gRG9uJ3QgdXBkYXRlIHRoZSBxdWljayBzd2l0Y2hlcidzIHJlY2VudCBsaXN0XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKF9maWxlICE9PSBmaWxlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gb2xkLmNhbGwodGhpcywgX2ZpbGUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRcdFx0fSksXG5cdFx0XHRcdFx0XHRcdFx0MSxcblx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcmVjZW50RmlsZXMgPSB0aGlzLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJyZWNlbnQtZmlsZXMtb2JzaWRpYW5cIl07XG5cdFx0XHRcdFx0XHRcdGlmIChyZWNlbnRGaWxlcykge1xuXHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoXG5cdFx0XHRcdFx0XHRcdFx0XHRhcm91bmQocmVjZW50RmlsZXMsIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2hvdWxkQWRkRmlsZShvbGQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKF9maWxlOiBURmlsZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gRG9uJ3QgdXBkYXRlIHRoZSBSZWNlbnQgRmlsZXMgcGx1Z2luXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gX2ZpbGUgIT09IGZpbGUgJiYgb2xkLmNhbGwodGhpcywgX2ZpbGUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRcdFx0XHR9KSxcblx0XHRcdFx0XHRcdFx0XHRcdDEsXG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGNvbnN0IHZpZXcgPSBvbGQuY2FsbCh0aGlzLCBmaWxlLCBvcGVuU3RhdGUpO1xuXHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKT0+e1xuXHRcdFx0XHRcdFx0XHRjb25zdCBmc0N0bkVsID0gKHRoaXMucGFyZW50LmNvbnRhaW5lckVsIGFzIEhUTUxFbGVtZW50KS5wYXJlbnRFbGVtZW50O1xuXHRcdFx0XHRcdFx0XHRpZighKGZzQ3RuRWw/LmNsYXNzTGlzdC5jb250YWlucyhcImZzLWNvbnRlbnRcIikpKSByZXR1cm47XG5cdFx0XHRcdFx0XHRcdGlmKGZpbGUuZXh0ZW5zaW9uICE9IFwiY2FudmFzXCIgKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdFx0Y29uc3QgY2FudmFzID0gdGhpcy52aWV3LmNhbnZhcztcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKT0+e1xuXHRcdFx0XHRcdFx0XHRcdGlmKGNhbnZhcyAmJiBvcGVuU3RhdGU/LmVTdGF0ZT8ubWF0Y2gpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxldCBub2RlID0gY2FudmFzLmRhdGEubm9kZXM/LmZpbmQoKGU6IGFueSk9PiBlLnRleHQgPT09IG9wZW5TdGF0ZS5lU3RhdGUubWF0Y2guY29udGVudCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRub2RlID0gY2FudmFzLm5vZGVzLmdldChub2RlLmlkKTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Y2FudmFzLnNlbGVjdE9ubHkobm9kZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRjYW52YXMuem9vbVRvU2VsZWN0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSwyMCk7XG5cdFx0XHRcdFx0XHR9LCAxKTtcblxuXHRcdFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KSxcblx0XHQpO1xuXHR9XG5cblx0cmVnaXN0ZXJPYnNpZGlhblVSSUhhbmRsZXIoKSB7XG5cdFx0dGhpcy5yZWdpc3Rlck9ic2lkaWFuUHJvdG9jb2xIYW5kbGVyKFwiZnNcIiwgKHBhdGgpPT57XG5cdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xuXHRcdFx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRcdHRoaXMuYXBwbHlTZXR0aW5nc1VwZGF0ZSgpO1xuXHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgeyBxdWVyeTogcGF0aC5xdWVyeSwgY3VycmVudDogZmFsc2UgfSk7XG5cdFx0XHR0aGlzLm1vZGFsLm9wZW4oKTtcblx0XHR9KTtcblx0fVxuXG5cdHJlZ2lzdGVyT2JzaWRpYW5Db21tYW5kcygpIHtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdzZWFyY2gtb2JzaWRpYW4tZ2xvYmFsbHknLFxuXHRcdFx0bmFtZTogJ1NlYXJjaCBPYnNpZGlhbiBHbG9iYWxseScsXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xuXHRcdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcblx0XHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgey4uLnRoaXMuc3RhdGUsIHF1ZXJ5OiBcIlwiLCBjdXJyZW50OiBmYWxzZX0pO1xuXHRcdFx0XHR0aGlzLm1vZGFsLm9wZW4oKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnc2VhcmNoLW9ic2lkaWFuLWdsb2JhbGx5LXN0YXRlJyxcblx0XHRcdG5hbWU6ICdTZWFyY2ggT2JzaWRpYW4gR2xvYmFsbHkgKFdpdGggTGFzdCBTdGF0ZSknLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0dGhpcy5tb2RhbCA9IG5ldyBGbG9hdFNlYXJjaE1vZGFsKChzdGF0ZSk9Pntcblx0XHRcdFx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRcdH0sdGhpcy5hcHAsIHRoaXMsIHsuLi50aGlzLnN0YXRlLCBjdXJyZW50OiBmYWxzZX0pO1xuXHRcdFx0XHR0aGlzLm1vZGFsLm9wZW4oKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHQgICAgaWQ6ICdzZWFyY2gtaW4tYmFja2xpbmsnLFxuXHRcdCAgICBuYW1lOiAnU2VhcmNoIEluIEJhY2tsaW5rIE9mIEN1cnJlbnQgRmlsZScsXG5cdFx0ICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdCAgICAgICAgLy8gQ29uZGl0aW9ucyB0byBjaGVja1xuXHRcdFx0XHRjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWY7XG5cdFx0XHRcdGlmKCFhY3RpdmVMZWFmKSByZXR1cm47XG5cblx0XHRcdFx0Y29uc3Qgdmlld1R5cGUgPSBhY3RpdmVMZWFmLnZpZXcuZ2V0Vmlld1R5cGUoKTtcblx0XHRcdFx0aWYgKHZpZXdUeXBlID09PSBcIm1hcmtkb3duXCIgfHwgdmlld1R5cGUgPT09IFwiY2FudmFzXCIpIHtcblx0XHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IGFjdGl2ZUxlYWYudmlldy5maWxlO1xuXG5cdFx0XHRcdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xuXHRcdFx0XHRcdFx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRcdFx0XHRcdHRoaXMuYXBwbHlTZXR0aW5nc1VwZGF0ZSgpO1xuXHRcdFx0XHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgey4uLnRoaXMuc3RhdGUsIHF1ZXJ5OiBcIiAvXFxcXFtcXFxcW1wiICsgKGN1cnJlbnRGaWxlLmV4dGVuc2lvbiA9PT0gXCJjYW52YXNcIiA/IGN1cnJlbnRGaWxlLm5hbWUgOiBjdXJyZW50RmlsZS5iYXNlbmFtZSkgKyBcIihcXFxcfFteXFxcXF1dKik/XFxcXF1cXFxcXS9cIiwgY3VycmVudDogdHJ1ZSB9KTtcblx0XHRcdFx0XHRcdHRoaXMubW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0ICAgIH1cblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0ICAgIGlkOiAnc2VhcmNoLWluLWN1cnJlbnQtZmlsZScsXG5cdFx0ICAgIG5hbWU6ICdTZWFyY2ggSW4gQ3VycmVudCBGaWxlJyxcblx0XHQgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG5cdFx0ICAgICAgICAvLyBDb25kaXRpb25zIHRvIGNoZWNrXG5cdFx0XHRcdGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZjtcblx0XHRcdFx0aWYoIWFjdGl2ZUxlYWYpIHJldHVybjtcblxuXHRcdFx0XHRjb25zdCB2aWV3VHlwZSA9IGFjdGl2ZUxlYWYudmlldy5nZXRWaWV3VHlwZSgpO1xuXHRcdCAgICAgICAgaWYgKHZpZXdUeXBlID09PSBcIm1hcmtkb3duXCIgfHwgdmlld1R5cGUgPT09IFwiY2FudmFzXCIpIHtcblx0XHQgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IGFjdGl2ZUxlYWYudmlldy5maWxlO1xuXG5cdFx0XHRcdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xuXHRcdFx0XHRcdFx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRcdFx0XHRcdHRoaXMuYXBwbHlTZXR0aW5nc1VwZGF0ZSgpO1xuXHRcdFx0XHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgey4uLnRoaXMuc3RhdGUsIHF1ZXJ5OiBcIiBwYXRoOlwiICsgY3VycmVudEZpbGUucGF0aCwgY3VycmVudDogdHJ1ZSB9KTtcblx0XHRcdFx0XHRcdHRoaXMubW9kYWwub3BlbigpO1xuXHRcdCAgICAgICAgICAgIH1cblxuXHRcdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHRcdCAgICAgICAgfVxuXHRcdCAgICB9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdCAgICBpZDogJ29wZW4tc2VhcmNoLXZpZXcnLFxuXHRcdCAgICBuYW1lOiAnT3BlbiBTZWFyY2ggVmlldycsXG5cdFx0ICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxlYWYgPSBhcHAud29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRcdFx0bGVhZi5zZXRQaW5uZWQodHJ1ZSk7XG5cdFx0XHRcdGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcblx0XHRcdFx0XHR0eXBlOiBcInNlYXJjaFwiLFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHJlZ2lzdGVyRWRpdG9yTWVudUhhbmRsZXIoKSB7XG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51OiBNZW51LCBlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG5cdFx0XHRcdGlmICghZWRpdG9yKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChlZGl0b3IuZ2V0U2VsZWN0aW9uKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKS50cmltKCk7XG5cdFx0XHRcdGxldCBzZWFyY2hXb3JkID0gc2VsZWN0aW9uO1xuXG5cdFx0XHRcdGlmKHNlbGVjdGlvbi5sZW5ndGggPiA4KSB7XG5cdFx0XHRcdFx0c2VhcmNoV29yZCA9IHNlbGVjdGlvbi5zdWJzdHJpbmcoMCwgMykgKyBcIi4uLlwiICsgc2VsZWN0aW9uLnN1YnN0cmluZyhzZWxlY3Rpb24ubGVuZ3RoIC0gMywgc2VsZWN0aW9uLmxlbmd0aCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2VhcmNoV29yZCA9IHNlbGVjdGlvbjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdC8vIEFkZCBzdWIgbWVudVxuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoJ1NlYXJjaCBcIicgKyBzZWFyY2hXb3JkICsgJ1wiJyArIFwiIGluIEZsb2F0IFNlYXJjaFwiKS5zZXRJY29uKFwic2VhcmNoXCIpXG5cdFx0XHRcdFx0XHQub25DbGljaygoKT0+e1xuXHRcdFx0XHRcdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmFwcGx5U2V0dGluZ3NVcGRhdGUoKTtcblx0XHRcdFx0XHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgeyBxdWVyeTogc2VsZWN0aW9uLCBjdXJyZW50OiBmYWxzZSB9KTtcblx0XHRcdFx0XHRcdFx0dGhpcy5tb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9KVxuXHRcdFx0fSkpXG5cdH1cblxuXHRyZWdpc3RlckNvbnRleHRNZW51SGFuZGxlcigpIHtcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0ICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJmaWxlLW1lbnVcIiwgKG1lbnU6IE1lbnUsIGZpbGU6IFRBYnN0cmFjdEZpbGUsIHNvdXJjZTogc3RyaW5nLCBsZWFmPzogV29ya3NwYWNlTGVhZikgPT4ge1xuXHRcdFx0Y29uc3QgcG9wb3ZlciA9IGxlYWYgPyBFbWJlZGRlZFZpZXcuZm9yTGVhZihsZWFmKSA6IHVuZGVmaW5lZDtcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgIXBvcG92ZXIgJiYgIWxlYWYpIHtcblx0XHRcdCAgbWVudS5hZGRJdGVtKGl0ZW0gPT4ge1xuXHRcdFx0XHRpdGVtXG5cdFx0XHRcdCAgLnNldEljb24oXCJwb3B1cC1vcGVuXCIpXG5cdFx0XHRcdCAgLnNldFRpdGxlKFwiT3BlbiBpbiBGbG9hdCBQcmV2aWV3XCIpXG5cdFx0XHRcdCAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdGlmKHRoaXMubW9kYWwpIHtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMubW9kYWwuaW5pdEZpbGVWaWV3KGZpbGUsIHVuZGVmaW5lZCk7XG5cblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xuXHRcdFx0XHRcdFx0dGhpcy5zdGF0ZSA9IHN0YXRlO1xuXHRcdFx0XHRcdFx0dGhpcy5hcHBseVNldHRpbmdzVXBkYXRlKCk7XG5cdFx0XHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgeyBxdWVyeTogXCJcIiwgY3VycmVudDogZmFsc2UgfSk7XG5cdFx0XHRcdFx0dGhpcy5tb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKT0+e1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5tb2RhbC5pbml0RmlsZVZpZXcoZmlsZSwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XHR9LCAyMCk7XG5cdFx0XHRcdCAgfSlcblx0XHRcdFx0ICAuc2V0U2VjdGlvbj8uKFwib3BlblwiKTtcblx0XHRcdCAgfSk7XG5cdFx0XHR9XG5cdFx0ICB9KSxcblx0XHQpO1xuXHQgIH1cbn1cblxuXG5jbGFzcyBGbG9hdFNlYXJjaE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRwcml2YXRlIHJlYWRvbmx5IHBsdWdpbjogRmxvYXRTZWFyY2hQbHVnaW47XG5cdHByaXZhdGUgc2VhcmNoRW1iZWRkZWRWaWV3OiBFbWJlZGRlZFZpZXc7XG5cdHByaXZhdGUgZmlsZUVtYmVkZGVkVmlldzogRW1iZWRkZWRWaWV3O1xuXG5cdHNlYXJjaExlYWY6IFdvcmtzcGFjZUxlYWY7XG5cdGZpbGVMZWFmOiBXb3Jrc3BhY2VMZWFmIHwgdW5kZWZpbmVkO1xuXG5cdHByaXZhdGUgY2I6IChzdGF0ZTogYW55KT0+IHZvaWQ7XG5cdHByaXZhdGUgc3RhdGU6IGFueTtcblxuXHRwcml2YXRlIGZpbGVTdGF0ZTogYW55O1xuXG5cdHByaXZhdGUgc2VhcmNoQ3RuRWw6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGluc3RydWN0aW9uc0VsOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBmaWxlRWw6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHZpZXdUeXBlOiBzdHJpbmc7XG5cblx0Y29uc3RydWN0b3IoY2I6IChzdGF0ZTogYW55KT0+IHZvaWQsIGFwcDogQXBwLCBwbHVnaW46IEZsb2F0U2VhcmNoUGx1Z2luLCBzdGF0ZTogYW55LCB2aWV3VHlwZTogc3RyaW5nID0gXCJzZWFyY2hcIikge1xuXHRcdHN1cGVyKGFwcCk7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jYiA9IGNiO1xuXHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcblx0XHR0aGlzLnZpZXdUeXBlID0gdmlld1R5cGU7XG5cdH1cblxuXHRhc3luYyBvbk9wZW4oKSB7XG5cdFx0Y29uc3QgeyBjb250ZW50RWwsIGNvbnRhaW5lckVsLCBtb2RhbEVsIH0gPSB0aGlzO1xuXG5cdFx0dGhpcy5zZWFyY2hDdG5FbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLXNlYXJjaC1jdG5cIiB9KTtcblx0XHR0aGlzLmluc3RydWN0aW9uc0VsID0gbW9kYWxFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9uc1wiIH0pO1xuXG5cdFx0dGhpcy5pbml0SW5zdHJ1Y3Rpb25zKHRoaXMuaW5zdHJ1Y3Rpb25zRWwpO1xuXHRcdHRoaXMuaW5pdENzcyhjb250ZW50RWwsIG1vZGFsRWwsIGNvbnRhaW5lckVsKTtcblx0XHRhd2FpdCB0aGlzLmluaXRTZWFyY2hWaWV3KHRoaXMuc2VhcmNoQ3RuRWwsIHRoaXMudmlld1R5cGUpO1xuXHRcdHRoaXMuaW5pdElucHV0KCk7XG5cdFx0dGhpcy5pbml0Q29udGVudCgpO1xuXHR9XG5cblx0b25DbG9zZSgpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuXHRcdHRoaXMuY2IodGhpcy5zZWFyY2hMZWFmLnZpZXcuZ2V0U3RhdGUoKSk7XG5cblx0XHR0aGlzLnNlYXJjaExlYWYuZGV0YWNoKCk7XG5cdFx0dGhpcy5maWxlTGVhZj8uZGV0YWNoKCk7XG5cdFx0dGhpcy5zZWFyY2hFbWJlZGRlZFZpZXcudW5sb2FkKCk7XG5cdFx0dGhpcy5maWxlRW1iZWRkZWRWaWV3Py51bmxvYWQoKTtcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0fVxuXG5cdGluaXRJbnN0cnVjdGlvbnMoaW5zdHJ1Y3Rpb25zRWw6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgbmF2aWdhdGVJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLW5hdmlnYXRlXCIgfSk7XG5cdFx0Y29uc3QgY29sbGFwc2VJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWNvbGxhcHNlXCIgfSk7XG5cdFx0Y29uc3QgZW50ZXJJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWVudGVyXCIgfSk7XG5cdFx0Y29uc3QgYWx0RW50ZXJJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWFsdC1lbnRlclwiIH0pO1xuXG5cdFx0Y29uc3QgdGFiSW5zdHJ1Y3Rpb25zRWwgPSBpbnN0cnVjdGlvbnNFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10YWJcIiB9KTtcblx0XHRjb25zdCBzd2l0Y2hJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXN3aXRjaFwiIH0pO1xuXG5cdFx0Y29uc3QgbmF2aWdhdGVJY29uRWwgPSBuYXZpZ2F0ZUluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy1rZXlcIiB9KTtcblx0XHRjb25zdCBuYXZpZ2F0ZVRleHRFbCA9IG5hdmlnYXRlSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXRleHRcIiB9KTtcblx0XHRuYXZpZ2F0ZUljb25FbC5zZXRUZXh0KFwiXHUyMTkxXHUyMTkzXCIpO1xuXHRcdG5hdmlnYXRlVGV4dEVsLnNldFRleHQoXCJOYXZpZ2F0ZVwiKTtcblxuXHRcdGNvbnN0IGNvbGxhcHNlSWNvbkVsID0gY29sbGFwc2VJbnN0cnVjdGlvbnNFbC5jcmVhdGVTcGFuKHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1pbnN0cnVjdGlvbnMta2V5XCIgfSk7XG5cdFx0Y29uc3QgY29sbGFwc2VUZXh0RWwgPSBjb2xsYXBzZUluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10ZXh0XCIgfSk7XG5cdFx0Y29sbGFwc2VJY29uRWwuc2V0VGV4dChcIlNoaWZ0K1x1MjE5MVx1MjE5M1wiKTtcblx0XHRjb2xsYXBzZVRleHRFbC5zZXRUZXh0KFwiQ29sbGFwc2UvRXhwYW5kXCIpO1xuXG5cdFx0Y29uc3QgZW50ZXJJY29uRWwgPSBlbnRlckluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy1rZXlcIiB9KTtcblx0XHRjb25zdCBlbnRlclRleHRFbCA9IGVudGVySW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXRleHRcIiB9KTtcblx0XHRlbnRlckljb25FbC5zZXRUZXh0KFwiXHUyMUI1XCIpO1xuXHRcdGVudGVyVGV4dEVsLnNldFRleHQoXCJPcGVuIGluIGJhY2tncm91bmRcIik7XG5cblx0XHRjb25zdCBhbHRFbnRlckljb25FbCA9IGFsdEVudGVySW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWtleVwiIH0pO1xuXHRcdGNvbnN0IGFsdEVudGVyVGV4dEVsID0gYWx0RW50ZXJJbnN0cnVjdGlvbnNFbC5jcmVhdGVTcGFuKHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1pbnN0cnVjdGlvbnMtdGV4dFwiIH0pO1xuXHRcdGFsdEVudGVySWNvbkVsLnNldFRleHQoXCJBbHQrXHUyMUI1XCIpO1xuXHRcdGFsdEVudGVyVGV4dEVsLnNldFRleHQoXCJPcGVuIEZpbGUgYW5kIENsb3NlXCIpO1xuXG5cdFx0Y29uc3QgdGFiSWNvbkVsID0gdGFiSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWtleVwiIH0pO1xuXHRcdGNvbnN0IHRhYlRleHRFbCA9IHRhYkluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10ZXh0XCIgfSk7XG5cdFx0dGFiSWNvbkVsLnNldFRleHQoXCJUYWIvU2hpZnQrVGFiXCIpO1xuXHRcdHRhYlRleHRFbC5zZXRUZXh0KFwiUHJldmlldy9DbG9zZSBQcmV2aWV3XCIpO1xuXG5cdFx0Y29uc3Qgc3dpdGNoSWNvbkVsID0gc3dpdGNoSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWtleVwiIH0pO1xuXHRcdGNvbnN0IHN3aXRjaFRleHRFbCA9IHN3aXRjaEluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10ZXh0XCIgfSk7XG5cdFx0c3dpdGNoSWNvbkVsLnNldFRleHQoXCJDdHJsK0dcIik7XG5cdFx0c3dpdGNoVGV4dEVsLnNldFRleHQoXCJTd2l0Y2ggQmV0d2VlbiBTZWFyY2ggYW5kIEZpbGUgVmlld1wiKTtcblxuXHRcdGNvbnN0IGNsaWNrSW5zdHJ1Y3Rpb25zRWwgPSBpbnN0cnVjdGlvbnNFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy1jbGlja1wiIH0pO1xuXHRcdGNvbnN0IGNsaWNrSWNvbkVsID0gY2xpY2tJbnN0cnVjdGlvbnNFbC5jcmVhdGVTcGFuKHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1pbnN0cnVjdGlvbnMta2V5XCIgfSk7XG5cdFx0Y29uc3QgY2xpY2tUZXh0RWwgPSBjbGlja0luc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10ZXh0XCIgfSk7XG5cdFx0Y2xpY2tJY29uRWwuc2V0VGV4dChcIkFsdCtDbGlja1wiKTtcblx0XHRjbGlja1RleHRFbC5zZXRUZXh0KFwiQ2xvc2UgTW9kYWwgV2hpbGUgSW4gRmlsZSBWaWV3XCIpO1xuXHR9XG5cblx0aW5pdENzcyhjb250ZW50RWw6IEhUTUxFbGVtZW50LCBtb2RhbEVsOiBIVE1MRWxlbWVudCwgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29udGVudEVsLmNsYXNzTGlzdC5hZGQoXCJmbG9hdC1zZWFyY2gtbW9kYWwtY29udGVudFwiKTtcblx0XHRtb2RhbEVsLmNsYXNzTGlzdC5hZGQoXCJmbG9hdC1zZWFyY2gtbW9kYWxcIik7XG5cdFx0Y29udGFpbmVyRWwuY2xhc3NMaXN0LmFkZChcImZsb2F0LXNlYXJjaC1tb2RhbC1jb250YWluZXJcIik7XG5cdH1cblxuXHRhc3luYyBpbml0U2VhcmNoVmlldyhjb250ZW50RWw6IEhUTUxFbGVtZW50LCB2aWV3VHlwZTogc3RyaW5nKSB7XG5cdFx0Y29uc3QgW2NyZWF0ZWRMZWFmLCBlbWJlZGRlZFZpZXddID0gc3Bhd25MZWFmVmlldyh0aGlzLnBsdWdpbiwgY29udGVudEVsKTtcblx0XHR0aGlzLnNlYXJjaExlYWYgPSBjcmVhdGVkTGVhZjtcblx0XHR0aGlzLnNlYXJjaEVtYmVkZGVkVmlldyA9IGVtYmVkZGVkVmlldztcblxuXHRcdHRoaXMuc2VhcmNoTGVhZi5zZXRQaW5uZWQodHJ1ZSk7XG5cdFx0YXdhaXQgdGhpcy5zZWFyY2hMZWFmLnNldFZpZXdTdGF0ZSh7XG5cdFx0XHR0eXBlOiBcInNlYXJjaFwiLFxuXHRcdH0pO1xuXG5cdFx0c2V0VGltZW91dChhc3luYyAoKT0+e1xuXHRcdFx0YXdhaXQgdGhpcy5zZWFyY2hMZWFmLnZpZXcuc2V0U3RhdGUodGhpcy5zdGF0ZSwgdHJ1ZSk7XG5cdFx0XHR0aGlzLnN0YXRlPy5jdXJyZW50ID8gKHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLnNldFNlbGVjdGlvblJhbmdlKDAsIDApIDogKHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLnNldFNlbGVjdGlvblJhbmdlKHRoaXMuc3RhdGU/LnF1ZXJ5Py5sZW5ndGgsIHRoaXMuc3RhdGU/LnF1ZXJ5Py5sZW5ndGgpO1xuXHRcdH0sIDApO1xuXG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0aW5pdElucHV0KCkge1xuXHRcdGNvbnN0IGlucHV0RWwgPSB0aGlzLmNvbnRlbnRFbC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuXHRcdGlucHV0RWwuZm9jdXMoKTtcblx0XHRpbnB1dEVsLm9ua2V5ZG93biA9IChlKSA9PiB7XG5cdFx0XHRjb25zdCBjdXJyZW50VmlldyA9IHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXc7XG5cdFx0XHRzd2l0Y2ggKGUua2V5KSB7XG5cdFx0XHRcdGNhc2UgXCJBcnJvd0Rvd25cIjpcblx0XHRcdFx0XHRpZiAoZS5zaGlmdEtleSkge1xuXHRcdFx0XHRcdFx0Y3VycmVudFZpZXcub25LZXlTaG93TW9yZUFmdGVyKGUpO1xuXHRcdFx0XHRcdFx0aWYoY3VycmVudFZpZXcuZG9tLmZvY3VzZWRJdGVtKSB7XG5cdFx0XHRcdFx0XHRcdGlmKGN1cnJlbnRWaWV3LmRvbS5mb2N1c2VkSXRlbS5jb2xsYXBzaWJsZSkge1xuXHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRWaWV3LmRvbS5mb2N1c2VkSXRlbS5zZXRDb2xsYXBzZShmYWxzZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjdXJyZW50Vmlldy5vbktleUFycm93RG93bkluRm9jdXMoZSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGNhc2UgXCJBcnJvd1VwXCI6XG5cdFx0XHRcdFx0aWYgKGUuc2hpZnRLZXkpIHtcblx0XHRcdFx0XHRcdGN1cnJlbnRWaWV3Lm9uS2V5U2hvd01vcmVCZWZvcmUoZSk7XG5cdFx0XHRcdFx0XHRpZihjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0pIHtcblx0XHRcdFx0XHRcdFx0aWYoY3VycmVudFZpZXcuZG9tLmZvY3VzZWRJdGVtLmNvbGxhcHNlRWwpIHtcblx0XHRcdFx0XHRcdFx0XHRjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0uc2V0Q29sbGFwc2UodHJ1ZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjdXJyZW50Vmlldy5vbktleUFycm93VXBJbkZvY3VzKGUpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRjYXNlIFwiQXJyb3dMZWZ0XCI6XG5cdFx0XHRcdFx0Y3VycmVudFZpZXcub25LZXlBcnJvd0xlZnRJbkZvY3VzKGUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiQXJyb3dSaWdodFwiOlxuXHRcdFx0XHRcdGN1cnJlbnRWaWV3Lm9uS2V5QXJyb3dSaWdodEluRm9jdXMoZSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJFbnRlclwiOlxuXHRcdFx0XHRcdGN1cnJlbnRWaWV3Lm9uS2V5RW50ZXJJbkZvY3VzKGUpO1xuXHRcdFx0XHRcdGlmKGUuYWx0S2V5ICYmIGN1cnJlbnRWaWV3LmRvbS5mb2N1c2VkSXRlbSkge1xuXHRcdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcIlRhYlwiOlxuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRpZihlLnNoaWZ0S2V5KSB7XG5cdFx0XHRcdFx0XHRpZih0aGlzLmZpbGVMZWFmKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZmlsZUxlYWY/LmRldGFjaCgpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmZpbGVMZWFmID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmZpbGVFbWJlZGRlZFZpZXc/LnVubG9hZCgpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLm1vZGFsRWwudG9nZ2xlQ2xhc3MoXCJmbG9hdC1zZWFyY2gtd2lkdGhcIiwgZmFsc2UpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmZpbGVFbC5kZXRhY2goKTtcblxuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZihjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0pIHtcblx0XHRcdFx0XHRcdGNvbnN0IGl0ZW0gPSBjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW07XG5cdFx0XHRcdFx0XHRjb25zdCBmaWxlID0gaXRlbS5wYXJlbnQuZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gaXRlbS5wYXJlbnQuZmlsZSA6IGl0ZW0uZmlsZTtcblxuXHRcdFx0XHRcdFx0aXRlbS5wYXJlbnQuZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gdGhpcy5pbml0RmlsZVZpZXcoZmlsZSwge21hdGNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogaXRlbS5jb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXM6IGl0ZW0ubWF0Y2hlc1xuICAgICAgICAgICAgICAgICAgICAgICAgfX0pIDogdGhpcy5pbml0RmlsZVZpZXcoZmlsZSwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJlXCI6XG5cdFx0XHRcdFx0aWYoZS5jdHJsS2V5KSB7XG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRpZih0aGlzLmZpbGVMZWFmKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGVzdGF0ZSA9IHRoaXMuZmlsZUxlYWYuZ2V0Vmlld1N0YXRlKCk7XG4gICAgICAgICAgICAgICAgXHRcdFx0ZXN0YXRlLnN0YXRlLm1vZGUgPSBcInByZXZpZXdcIiA9PT0gZXN0YXRlLnN0YXRlLm1vZGUgPyBcInNvdXJjZVwiIDogXCJwcmV2aWV3XCI7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZmlsZUxlYWYuc2V0Vmlld1N0YXRlKGVzdGF0ZSwge1xuXHRcdFx0XHRcdFx0XHRcdGZvY3VzOiAhMFxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKT0+e1xuXHRcdFx0XHRcdFx0XHRcdCh0aGlzLnNlYXJjaExlYWYudmlldyBhcyBTZWFyY2hWaWV3KS5zZWFyY2hDb21wb25lbnQuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHR9LCAwKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0Y2FzZSBcImdcIjpcblx0XHRcdFx0XHRpZih0aGlzLmZpbGVMZWFmICYmIGUuY3RybEtleSkge1xuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0YXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKHRoaXMuZmlsZUxlYWYsIHtcblx0XHRcdFx0XHRcdFx0Zm9jdXM6IHRydWUsXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJDXCI6XG5cdFx0XHRcdFx0aWYoZS5jdHJsS2V5ICYmIGUuc2hpZnRLZXkpIHtcblx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdGNvbnN0IHRleHQgPSBjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0uZWwuaW5uZXJUZXh0O1xuXHRcdFx0XHRcdFx0bmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodGV4dCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aW5pdENvbnRlbnQoKSB7XG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLm9uY2xpY2sgPSAoZSkgPT4ge1xuXHRcdFx0Y29uc3QgcmVzdWx0RWxlbWVudCA9IGNvbnRlbnRFbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzZWFyY2gtcmVzdWx0cy1jaGlsZHJlbicpWzBdO1xuXHRcdFx0aWYocmVzdWx0RWxlbWVudC5jaGlsZHJlbi5sZW5ndGggPCAyKSAge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGxldCB0YXJnZXRFbGVtZW50ID0gZS50YXJnZXQgYXMgSFRNTEVsZW1lbnQgfCBudWxsO1xuXG5cdFx0XHRpZihlLmFsdEtleSB8fCAhdGhpcy5maWxlTGVhZikge1xuXHRcdFx0XHR3aGlsZSAodGFyZ2V0RWxlbWVudCkge1xuXHRcdFx0XHRcdGlmICh0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygndHJlZS1pdGVtJykpIHtcblx0XHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0YXJnZXRFbGVtZW50ID0gdGFyZ2V0RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYodGhpcy5maWxlTGVhZikge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50VmlldyA9IHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXc7XG5cblx0XHRcdFx0aWYoKHRoaXMuc2VhcmNoQ3RuRWwgYXMgTm9kZSkuY29udGFpbnModGFyZ2V0RWxlbWVudCBhcyBOb2RlKSkge1xuXHRcdFx0XHRcdHdoaWxlICh0YXJnZXRFbGVtZW50KSB7XG5cdFx0XHRcdFx0XHRpZiAodGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3RyZWUtaXRlbScpKSB7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dGFyZ2V0RWxlbWVudCA9IHRhcmdldEVsZW1lbnQucGFyZW50RWxlbWVudDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYoIXRhcmdldEVsZW1lbnQpIHJldHVybjtcblxuXHRcdFx0XHRcdGNvbnN0IGZpbGVJbm5lckVsID0gdGFyZ2V0RWxlbWVudD8uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRyZWUtaXRlbS1pbm5lclwiKVswXSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0XHRjb25zdCBpbm5lclRleHQgPSBmaWxlSW5uZXJFbC5pbm5lclRleHQ7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGlubmVyVGV4dCwgXCJcIik7XG5cblx0XHRcdFx0XHRpZihmaWxlKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBpdGVtID0gY3VycmVudFZpZXcuZG9tLnJlc3VsdERvbUxvb2t1cC5nZXQoZmlsZSk7XG5cdFx0XHRcdFx0XHRjdXJyZW50Vmlldy5kb20uc2V0Rm9jdXNlZEl0ZW0oaXRlbSk7XG5cdFx0XHRcdFx0XHR0aGlzLmluaXRGaWxlVmlldyhmaWxlLCB1bmRlZmluZWQpO1xuXHRcdFx0XHRcdFx0KHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgaW5pdEZpbGVWaWV3KGZpbGU6IFRGaWxlLCBzdGF0ZTogYW55KSB7XG5cdFx0aWYodGhpcy5maWxlTGVhZikge1xuXHRcdFx0YXdhaXQgdGhpcy5maWxlTGVhZi5vcGVuRmlsZShmaWxlLCB7XG5cdFx0XHRcdGFjdGl2ZTogZmFsc2UsXG5cdFx0XHRcdGVTdGF0ZTogc3RhdGVcblx0XHRcdH0pO1xuXG5cdFx0XHRpZih0aGlzLmZpbGVTdGF0ZT8ubWF0Y2g/Lm1hdGNoZXNbMF0gPT09IHN0YXRlPy5tYXRjaD8ubWF0Y2hlc1swXSAmJiBzdGF0ZSAmJiB0aGlzLmZpbGVTdGF0ZSkge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpPT57XG5cdFx0XHRcdFx0aWYodGhpcy5maWxlTGVhZikge1xuXHRcdFx0XHRcdFx0YXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKHRoaXMuZmlsZUxlYWYsIHtcblx0XHRcdFx0XHRcdFx0Zm9jdXM6IHRydWUsXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIDApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5maWxlU3RhdGUgPSBzdGF0ZTtcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0KHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHRcdH0sIDApO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0dGhpcy5maWxlRWwgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1maWxlLWN0blwiIH0pO1xuXHRcdHRoaXMubW9kYWxFbC50b2dnbGVDbGFzcyhcImZsb2F0LXNlYXJjaC13aWR0aFwiLCB0cnVlKTtcblx0XHR0aGlzLmZpbGVFbC5vbmtleWRvd24gPSAoZSkgPT4ge1xuXHRcdFx0aWYoZS5jdHJsS2V5ICYmIGUua2V5ID09PSBcImdcIikge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdFx0KHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKGUua2V5ID09PSBcIlRhYlwiICYmIGUuY3RybEtleSkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdFx0KHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYoIXRoaXMuZmlsZUVsKSByZXR1cm47XG5cblx0XHRjb25zdCBbY3JlYXRlZExlYWYsIGVtYmVkZGVkVmlld10gPSBzcGF3bkxlYWZWaWV3KHRoaXMucGx1Z2luLCB0aGlzLmZpbGVFbCk7XG5cdFx0dGhpcy5maWxlTGVhZiA9IGNyZWF0ZWRMZWFmO1xuXHRcdHRoaXMuZmlsZUVtYmVkZGVkVmlldyA9IGVtYmVkZGVkVmlldztcblxuXHRcdHRoaXMuZmlsZUxlYWYuc2V0UGlubmVkKHRydWUpO1xuXHRcdGF3YWl0IHRoaXMuZmlsZUxlYWYub3BlbkZpbGUoZmlsZSwge1xuXHRcdFx0YWN0aXZlOiBmYWxzZSxcblx0XHRcdGVTdGF0ZTogc3RhdGVcblx0XHR9KTtcblx0XHR0aGlzLmZpbGVTdGF0ZSA9IHN0YXRlO1xuXG5cdFx0KHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLmZvY3VzKCk7XG5cblx0fVxufVxuIiwgIi8vIE9yaWdpbmFsIGNvZGUgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vbm90aGluZ2lzbG9zdC9vYnNpZGlhbi1ob3Zlci1lZGl0b3IvYmxvYi85ZWMzNDQ5YmU5YWIzNDMzZGM0NmM0YzNhY2ZkZTFkYTcyZmYwMjYxL3NyYy9wb3BvdmVyLnRzXG4vLyBZb3UgY2FuIHVzZSB0aGlzIGZpbGUgYXMgYSBiYXNpYyBsZWFmIHZpZXcgY3JlYXRlIG1ldGhvZCBpbiBhbnl3aGVyZVxuLy8gUGxlYXNlIHJlbWVtZWJlciBpZiB5b3Ugd2FudCB0byB1c2UgdGhpcyBmaWxlLCB5b3Ugc2hvdWxkIHBhdGNoIHRoZSB0eXBlcy1vYnNpZGlhbi5kLnRzIGZpbGVcbi8vIEFuZCBhbHNvIG1vbmtleSBhcm91bmQgdGhlIE9ic2lkaWFuIG9yaWdpbmFsIG1ldGhvZC5cbmltcG9ydCB7XG4gICAgQ29tcG9uZW50LFxuXHRFcGhlbWVyYWxTdGF0ZSxcbiAgICBIb3ZlclBvcG92ZXIsXG4gICAgTWFya2Rvd25FZGl0VmlldyxcbiAgICBwYXJzZUxpbmt0ZXh0LFxuICAgIFBvcG92ZXJTdGF0ZSxcbiAgICByZXF1aXJlQXBpVmVyc2lvbixcbiAgICByZXNvbHZlU3VicGF0aCxcbiAgICBURmlsZSxcbiAgICBWaWV3LFxuICAgIFdvcmtzcGFjZSxcbiAgICBXb3Jrc3BhY2VMZWFmLFxuICAgIFdvcmtzcGFjZVNwbGl0LFxuICAgIFdvcmtzcGFjZVRhYnMsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHR5cGUgeyBPcGVuVmlld1N0YXRlIH0gZnJvbSBcInNyYy90eXBlcy90eXBlcy1vYnNpZGlhblwiO1xuaW1wb3J0IHR5cGUgRmxvYXRTZWFyY2hQbHVnaW4gZnJvbSBcInNyYy9mbG9hdFNlYXJjaEluZGV4XCI7XG5cblxuZXhwb3J0IGludGVyZmFjZSBFbWJlZGRlZFZpZXdQYXJlbnQge1xuICAgIGhvdmVyUG9wb3ZlcjogRW1iZWRkZWRWaWV3IHwgbnVsbDtcbiAgICBjb250YWluZXJFbD86IEhUTUxFbGVtZW50O1xuICAgIHZpZXc/OiBWaWV3O1xuICAgIGRvbT86IEhUTUxFbGVtZW50O1xufVxuY29uc3QgcG9wb3ZlcnMgPSBuZXcgV2Vha01hcDxFbGVtZW50LCBFbWJlZGRlZFZpZXc+KCk7XG50eXBlIENvbnN0cnVjdGFibGVXb3Jrc3BhY2VTcGxpdCA9IG5ldyAod3M6IFdvcmtzcGFjZSwgZGlyOiBcImhvcml6b250YWxcInxcInZlcnRpY2FsXCIpID0+IFdvcmtzcGFjZVNwbGl0O1xuXG5leHBvcnQgZnVuY3Rpb24gaXNFbWViZWRkZWRMZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYpIHtcbiAgICAvLyBXb3JrIGFyb3VuZCBtaXNzaW5nIGVuaGFuY2UuanMgQVBJIGJ5IGNoZWNraW5nIG1hdGNoIGNvbmRpdGlvbiBpbnN0ZWFkIG9mIGxvb2tpbmcgdXAgcGFyZW50XG4gICAgcmV0dXJuIGxlYWYuY29udGFpbmVyRWwubWF0Y2hlcyhcIi5mcy1ibG9jay5mcy1sZWFmLXZpZXcgLndvcmtzcGFjZS1sZWFmXCIpO1xufVxuXG5mdW5jdGlvbiBnZW5JZChzaXplOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNoYXJzID0gW107XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCBzaXplOyBuKyspIGNoYXJzLnB1c2goKCgxNiAqIE1hdGgucmFuZG9tKCkpIHwgMCkudG9TdHJpbmcoMTYpKTtcbiAgICByZXR1cm4gY2hhcnMuam9pbihcIlwiKTtcbn1cblxuZnVuY3Rpb24gbm9zdXBlcjxUPihiYXNlOiBuZXcgKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gVCk6IG5ldyAoKSA9PiBUIHtcbiAgICBjb25zdCBkZXJpdmVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKG5ldyBDb21wb25lbnQsIG5ldy50YXJnZXQucHJvdG90eXBlKTtcbiAgICB9O1xuICAgIGRlcml2ZWQucHJvdG90eXBlID0gYmFzZS5wcm90b3R5cGU7XG4gICAgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZihkZXJpdmVkLCBiYXNlKTtcbn1cblxuZXhwb3J0IGNvbnN0IHNwYXduTGVhZlZpZXcgPSAocGx1Z2luOiBGbG9hdFNlYXJjaFBsdWdpbiwgaW5pdGlhdGluZ0VsPzogSFRNTEVsZW1lbnQsIGxlYWY/OiBXb3Jrc3BhY2VMZWFmLCBvblNob3dDYWxsYmFjaz86ICgpID0+IHVua25vd24pOiBbV29ya3NwYWNlTGVhZiwgRW1iZWRkZWRWaWV3XSA9PiB7XG4gICAgLy8gV2hlbiBPYnNpZGlhbiBkb2Vzbid0IHNldCBhbnkgbGVhZiBhY3RpdmUsIHVzZSBsZWFmIGluc3RlYWQuXG4gICAgbGV0IHBhcmVudCA9IGFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZiBhcyB1bmtub3duIGFzIEVtYmVkZGVkVmlld1BhcmVudDtcbiAgICBpZiAoIXBhcmVudCkgcGFyZW50ID0gbGVhZiBhcyB1bmtub3duIGFzIEVtYmVkZGVkVmlld1BhcmVudDtcblxuICAgIGlmICghaW5pdGlhdGluZ0VsKSBpbml0aWF0aW5nRWwgPSBwYXJlbnQ/LmNvbnRhaW5lckVsO1xuXG4gICAgY29uc3QgaG92ZXJQb3BvdmVyID0gbmV3IEVtYmVkZGVkVmlldyhwYXJlbnQsIGluaXRpYXRpbmdFbCEsIHBsdWdpbiwgdW5kZWZpbmVkLCBvblNob3dDYWxsYmFjayk7XG4gICAgcmV0dXJuIFtob3ZlclBvcG92ZXIuYXR0YWNoTGVhZigpLCBob3ZlclBvcG92ZXJdO1xuXG59XG5cbmV4cG9ydCBjbGFzcyBFbWJlZGRlZFZpZXcgZXh0ZW5kcyBub3N1cGVyKEhvdmVyUG9wb3Zlcikge1xuICAgIG9uVGFyZ2V0OiBib29sZWFuO1xuICAgIHNldEFjdGl2ZTogKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuXG4gICAgbG9ja2VkT3V0OiBib29sZWFuO1xuICAgIGFib3J0Q29udHJvbGxlcj8gPSB0aGlzLmFkZENoaWxkKG5ldyBDb21wb25lbnQoKSk7XG4gICAgZGV0YWNoaW5nID0gZmFsc2U7XG4gICAgb3BlbmluZyA9IGZhbHNlO1xuXG4gICAgcm9vdFNwbGl0OiBXb3Jrc3BhY2VTcGxpdCA9IG5ldyAoV29ya3NwYWNlU3BsaXQgYXMgQ29uc3RydWN0YWJsZVdvcmtzcGFjZVNwbGl0KSh3aW5kb3cuYXBwLndvcmtzcGFjZSwgXCJ2ZXJ0aWNhbFwiKTtcblxuICAgIGlzUGlubmVkID0gdHJ1ZTtcblxuICAgIHRpdGxlRWw6IEhUTUxFbGVtZW50O1xuICAgIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudDtcblxuICAgIC8vIEl0IGlzIGN1cnJlbnRseSBub3QgdXNlZnVsLlxuICAgIC8vIGxlYWZJbkhvdmVyRWw6IFdvcmtzcGFjZUxlYWY7XG5cbiAgICBvbGRQb3BvdmVyID0gdGhpcy5wYXJlbnQ/LmhvdmVyUG9wb3ZlcjtcbiAgICBkb2N1bWVudDogRG9jdW1lbnQgPSB0aGlzLnRhcmdldEVsPy5vd25lckRvY3VtZW50ID8/IHdpbmRvdy5hY3RpdmVEb2N1bWVudCA/PyB3aW5kb3cuZG9jdW1lbnQ7XG5cbiAgICBpZCA9IGdlbklkKDgpO1xuICAgIGJvdW5jZT86IE5vZGVKUy5UaW1lb3V0O1xuICAgIGJvdW5kT25ab29tT3V0OiAoKSA9PiB2b2lkO1xuXG4gICAgb3JpZ2luYWxQYXRoOiBzdHJpbmc7IC8vIHRoZXNlIGFyZSBrZXB0IHRvIGF2b2lkIGFkb3B0aW5nIHRhcmdldHMgdy9hIGRpZmZlcmVudCBsaW5rXG4gICAgb3JpZ2luYWxMaW5rVGV4dDogc3RyaW5nO1xuICAgIHN0YXRpYyBhY3RpdmVQb3BvdmVyPzogRW1iZWRkZWRWaWV3O1xuXG4gICAgc3RhdGljIGFjdGl2ZVdpbmRvd3MoKSB7XG4gICAgICAgIGNvbnN0IHdpbmRvd3M6IFdpbmRvd1tdID0gW3dpbmRvd107XG4gICAgICAgIGNvbnN0IHsgZmxvYXRpbmdTcGxpdCB9ID0gYXBwLndvcmtzcGFjZTtcbiAgICAgICAgaWYgKGZsb2F0aW5nU3BsaXQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc3BsaXQgb2YgZmxvYXRpbmdTcGxpdC5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIGlmIChzcGxpdC53aW4pIHdpbmRvd3MucHVzaChzcGxpdC53aW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3aW5kb3dzO1xuICAgIH1cblxuICAgIHN0YXRpYyBjb250YWluZXJGb3JEb2N1bWVudChkb2M6IERvY3VtZW50KSB7XG4gICAgICAgIGlmIChkb2MgIT09IGRvY3VtZW50ICYmIGFwcC53b3Jrc3BhY2UuZmxvYXRpbmdTcGxpdClcbiAgICAgICAgICAgIGZvciAoY29uc3QgY29udGFpbmVyIG9mIGFwcC53b3Jrc3BhY2UuZmxvYXRpbmdTcGxpdC5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuZG9jID09PSBkb2MpIHJldHVybiBjb250YWluZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHAud29ya3NwYWNlLnJvb3RTcGxpdDtcbiAgICB9XG5cbiAgICBzdGF0aWMgYWN0aXZlUG9wb3ZlcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZVdpbmRvd3MoKS5mbGF0TWFwKHRoaXMucG9wb3ZlcnNGb3JXaW5kb3cpO1xuICAgIH1cblxuICAgIHN0YXRpYyBwb3BvdmVyc0ZvcldpbmRvdyh3aW4/OiBXaW5kb3cpIHtcbiAgICAgICAgcmV0dXJuIChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh3aW4/LmRvY3VtZW50Py5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZnMtbGVhZi12aWV3XCIpID8/IFtdKSBhcyBIVE1MRWxlbWVudFtdKVxuICAgICAgICAgICAgLm1hcChlbCA9PiBwb3BvdmVycy5nZXQoZWwpISlcbiAgICAgICAgICAgIC5maWx0ZXIoaGUgPT4gaGUpO1xuICAgIH1cblxuICAgIHN0YXRpYyBmb3JMZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYgfCB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gbGVhZiBjYW4gYmUgbnVsbCBzdWNoIGFzIHdoZW4gcmlnaHQgY2xpY2tpbmcgb24gYW4gaW50ZXJuYWwgbGlua1xuICAgICAgICBjb25zdCBlbCA9IGxlYWYgJiYgZG9jdW1lbnQuYm9keS5tYXRjaFBhcmVudC5jYWxsKGxlYWYuY29udGFpbmVyRWwsIFwiLmZzLWxlYWYtdmlld1wiKTsgLy8gd29yayBhcm91bmQgbWF0Y2hQYXJlbnQgcmFjZSBjb25kaXRpb25cbiAgICAgICAgcmV0dXJuIGVsID8gcG9wb3ZlcnMuZ2V0KGVsKSA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBzdGF0aWMgaXRlcmF0ZVBvcG92ZXJMZWF2ZXMod3M6IFdvcmtzcGFjZSwgY2I6IChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiBib29sZWFuIHwgdm9pZCkge1xuICAgICAgICBmb3IgKGNvbnN0IHBvcG92ZXIgb2YgdGhpcy5hY3RpdmVQb3BvdmVycygpKSB7XG4gICAgICAgICAgICBpZiAocG9wb3Zlci5yb290U3BsaXQgJiYgd3MuaXRlcmF0ZUxlYXZlcyhjYiwgcG9wb3Zlci5yb290U3BsaXQpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaG92ZXJFbDogSFRNTEVsZW1lbnQgPSB0aGlzLmRvY3VtZW50LmRlZmF1bHRWaWV3IS5jcmVhdGVEaXYoe1xuICAgICAgICBjbHM6IFwiZnMtYmxvY2sgZnMtbGVhZi12aWV3XCIsXG4gICAgICAgIGF0dHI6IHsgaWQ6IFwiZnMtXCIgKyB0aGlzLmlkIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcGFyZW50OiBFbWJlZGRlZFZpZXdQYXJlbnQsXG4gICAgICAgIHB1YmxpYyB0YXJnZXRFbDogSFRNTEVsZW1lbnQsXG4gICAgICAgIHB1YmxpYyBwbHVnaW46IEZsb2F0U2VhcmNoUGx1Z2luLFxuICAgICAgICB3YWl0VGltZT86IG51bWJlcixcbiAgICAgICAgcHVibGljIG9uU2hvd0NhbGxiYWNrPzogKCkgPT4gdW5rbm93bixcbiAgICApIHtcbiAgICAgICAgLy9cbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICBpZiAod2FpdFRpbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgd2FpdFRpbWUgPSAzMDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vblRhcmdldCA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMud2FpdFRpbWUgPSB3YWl0VGltZTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFBvcG92ZXJTdGF0ZS5TaG93aW5nO1xuICAgICAgICBjb25zdCB7IGhvdmVyRWwgfSA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5hYm9ydENvbnRyb2xsZXIhLmxvYWQoKTtcbiAgICAgICAgdGhpcy5zaG93KCk7XG4gICAgICAgIHRoaXMub25TaG93KCk7XG5cbiAgICAgICAgdGhpcy5zZXRBY3RpdmUgPSB0aGlzLl9zZXRBY3RpdmUuYmluZCh0aGlzKTtcbiAgICAgICAgLy8gaWYgKGhvdmVyRWwpIHtcbiAgICAgICAgLy8gICAgIGhvdmVyRWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLnNldEFjdGl2ZSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gY3VzdG9tIGxvZ2ljIGJlZ2luXG4gICAgICAgIHBvcG92ZXJzLnNldCh0aGlzLmhvdmVyRWwsIHRoaXMpO1xuICAgICAgICB0aGlzLmhvdmVyRWwuYWRkQ2xhc3MoXCJmcy1ibG9ja1wiKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbCA9IHRoaXMuaG92ZXJFbC5jcmVhdGVEaXYoXCJmcy1jb250ZW50XCIpO1xuICAgICAgICB0aGlzLmJ1aWxkV2luZG93Q29udHJvbHMoKTtcbiAgICAgICAgdGhpcy5zZXRJbml0aWFsRGltZW5zaW9ucygpO1xuICAgIH1cblxuICAgIF9zZXRBY3RpdmUoZXZ0OiBNb3VzZUV2ZW50KSB7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZih0aGlzLmxlYXZlcygpWzBdLCB7Zm9jdXM6IHRydWV9KVxuICAgIH1cblxuICAgIGdldERlZmF1bHRNb2RlKCkge1xuICAgICAgICAvLyByZXR1cm4gdGhpcy5wYXJlbnQ/LnZpZXc/LmdldE1vZGUgPyB0aGlzLnBhcmVudC52aWV3LmdldE1vZGUoKSA6IFwic291cmNlXCI7XG4gICAgICAgIHJldHVybiBcInNvdXJjZVwiO1xuICAgIH1cblxuICAgIHVwZGF0ZUxlYXZlcygpIHtcbiAgICAgICAgaWYgKHRoaXMub25UYXJnZXQgJiYgdGhpcy50YXJnZXRFbCAmJiAhdGhpcy5kb2N1bWVudC5jb250YWlucyh0aGlzLnRhcmdldEVsKSkge1xuICAgICAgICAgICAgdGhpcy5vblRhcmdldCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGxlYWZDb3VudCA9IDA7XG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUxlYXZlcyhsZWFmID0+IHtcbiAgICAgICAgICAgIGxlYWZDb3VudCsrO1xuICAgICAgICB9LCB0aGlzLnJvb3RTcGxpdCk7XG5cbiAgICAgICAgaWYgKGxlYWZDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5oaWRlKCk7IC8vIGNsb3NlIGlmIHdlIGhhdmUgbm8gbGVhdmVzXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ob3ZlckVsLnNldEF0dHJpYnV0ZShcImRhdGEtbGVhZi1jb3VudFwiLCBsZWFmQ291bnQudG9TdHJpbmcoKSk7XG4gICAgfVxuXG4gICAgbGVhdmVzKCkge1xuICAgICAgICBjb25zdCBsZWF2ZXM6IFdvcmtzcGFjZUxlYWZbXSA9IFtdO1xuICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLml0ZXJhdGVMZWF2ZXMobGVhZiA9PiB7XG4gICAgICAgICAgICBsZWF2ZXMucHVzaChsZWFmKTtcbiAgICAgICAgfSwgdGhpcy5yb290U3BsaXQpO1xuICAgICAgICByZXR1cm4gbGVhdmVzO1xuICAgIH1cblxuICAgIHNldEluaXRpYWxEaW1lbnNpb25zKCkge1xuXG4gICAgICAgIHRoaXMuaG92ZXJFbC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gICAgICAgIHRoaXMuaG92ZXJFbC5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuICAgIH1cblxuICAgIHRyYW5zaXRpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLnNob3VsZFNob3coKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFBvcG92ZXJTdGF0ZS5IaWRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlID0gUG9wb3ZlclN0YXRlLlNob3duO1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBQb3BvdmVyU3RhdGUuU2hvd2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gUG9wb3ZlclN0YXRlLlNob3duKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBQb3BvdmVyU3RhdGUuSGlkaW5nO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkU2hvdygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLndhaXRUaW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGJ1aWxkV2luZG93Q29udHJvbHMoKSB7XG4gICAgICAgIHRoaXMudGl0bGVFbCA9IHRoaXMuZG9jdW1lbnQuZGVmYXVsdFZpZXchLmNyZWF0ZURpdihcInBvcG92ZXItdGl0bGViYXJcIik7XG4gICAgICAgIHRoaXMudGl0bGVFbC5jcmVhdGVEaXYoXCJwb3BvdmVyLXRpdGxlXCIpO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwucHJlcGVuZCh0aGlzLnRpdGxlRWwpO1xuXG4gICAgfVxuXG4gICAgYXR0YWNoTGVhZigpOiBXb3Jrc3BhY2VMZWFmIHtcbiAgICAgICAgdGhpcy5yb290U3BsaXQuZ2V0Um9vdCA9ICgpID0+IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2VbdGhpcy5kb2N1bWVudCA9PT0gZG9jdW1lbnQgPyBcInJvb3RTcGxpdFwiIDogXCJmbG9hdGluZ1NwbGl0XCJdITtcbiAgICAgICAgdGhpcy5yb290U3BsaXQuZ2V0Q29udGFpbmVyID0gKCkgPT4gRW1iZWRkZWRWaWV3LmNvbnRhaW5lckZvckRvY3VtZW50KHRoaXMuZG9jdW1lbnQpO1xuXG4gICAgICAgIHRoaXMudGl0bGVFbC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJhZnRlcmVuZFwiLCB0aGlzLnJvb3RTcGxpdC5jb250YWluZXJFbCk7XG4gICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmNyZWF0ZUxlYWZJblBhcmVudCh0aGlzLnJvb3RTcGxpdCwgMCk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVMZWF2ZXMoKTtcbiAgICAgICAgcmV0dXJuIGxlYWY7XG4gICAgfVxuXG4gICAgb25sb2FkKCk6IHZvaWQge1xuICAgICAgICBzdXBlci5vbmxvYWQoKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJsYXlvdXQtY2hhbmdlXCIsIHRoaXMudXBkYXRlTGVhdmVzLCB0aGlzKSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChhcHAud29ya3NwYWNlLm9uKFwibGF5b3V0LWNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBFbnN1cmUgdGhhdCB0b3AtbGV2ZWwgaXRlbXMgaW4gYSBwb3BvdmVyIGFyZSBub3QgdGFiYmVkXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICB0aGlzLnJvb3RTcGxpdC5jaGlsZHJlbi5mb3JFYWNoKChpdGVtOiBhbnksIGluZGV4OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIFdvcmtzcGFjZVRhYnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290U3BsaXQucmVwbGFjZUNoaWxkKGluZGV4LCBpdGVtLmNoaWxkcmVuWzBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgb25TaG93KCkge1xuICAgICAgICAvLyBPbmNlIHdlJ3ZlIGJlZW4gb3BlbiBmb3IgY2xvc2VEZWxheSwgdXNlIHRoZSBjbG9zZURlbGF5IGFzIGEgaGlkaW5nIHRpbWVvdXRcbiAgICAgICAgY29uc3QgY2xvc2VEZWxheSA9IDYwMDtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiAodGhpcy53YWl0VGltZSA9IGNsb3NlRGVsYXkpLCBjbG9zZURlbGF5KTtcblxuICAgICAgICB0aGlzLm9sZFBvcG92ZXI/LmhpZGUoKTtcbiAgICAgICAgdGhpcy5vbGRQb3BvdmVyID0gbnVsbDtcblxuICAgICAgICB0aGlzLmhvdmVyRWwudG9nZ2xlQ2xhc3MoXCJpcy1uZXdcIiwgdHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICBcImNsaWNrXCIsXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5ob3ZlckVsLnRvZ2dsZUNsYXNzKFwiaXMtbmV3XCIsIGZhbHNlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7IG9uY2U6IHRydWUsIGNhcHR1cmU6IHRydWUgfSxcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmhvdmVyUG9wb3ZlciA9IHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgb3JpZ2luYWwgdmlldyBoZWFkZXI7XG4gICAgICAgIGNvbnN0IHZpZXdIZWFkZXJFbCA9IHRoaXMuaG92ZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctaGVhZGVyXCIpO1xuICAgICAgICB2aWV3SGVhZGVyRWw/LnJlbW92ZSgpO1xuXG4gICAgICAgIGNvbnN0IHNpemVyID0gdGhpcy5ob3ZlckVsLnF1ZXJ5U2VsZWN0b3IoXCIud29ya3NwYWNlLWxlYWZcIik7XG4gICAgICAgIGlmKHNpemVyKSB0aGlzLmhvdmVyRWwuYXBwZW5kQ2hpbGQoc2l6ZXIpO1xuXG4gICAgICAgIC8vIFJlbW92ZSBvcmlnaW5hbCBpbmxpbmUgdGlsdGU7XG4gICAgICAgIGNvbnN0IGlubGluZVRpdGxlID0gdGhpcy5ob3ZlckVsLnF1ZXJ5U2VsZWN0b3IoXCIuaW5saW5lLXRpdGxlXCIpO1xuICAgICAgICBpZihpbmxpbmVUaXRsZSkgaW5saW5lVGl0bGUucmVtb3ZlKCk7XG5cbiAgICAgICAgdGhpcy5vblNob3dDYWxsYmFjaz8uKCk7XG4gICAgICAgIHRoaXMub25TaG93Q2FsbGJhY2sgPSB1bmRlZmluZWQ7IC8vIG9ubHkgY2FsbCBpdCBvbmNlXG4gICAgfVxuXG4gICAgZGV0ZWN0KGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICAvLyBUT0RPOiBtYXkgbm90IGJlIG5lZWRlZD8gdGhlIG1vdXNlb3Zlci9vdXQgaGFuZGVycyBoYW5kbGUgbW9zdCBkZXRlY3Rpb24gdXNlIGNhc2VzXG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0RWwgfSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKHRhcmdldEVsKSB7XG4gICAgICAgICAgICB0aGlzLm9uVGFyZ2V0ID0gZWwgPT09IHRhcmdldEVsIHx8IHRhcmdldEVsLmNvbnRhaW5zKGVsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNob3VsZFNob3coKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNob3VsZFNob3dTZWxmKCkgfHwgdGhpcy5zaG91bGRTaG93Q2hpbGQoKTtcbiAgICB9XG5cbiAgICBzaG91bGRTaG93Q2hpbGQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBFbWJlZGRlZFZpZXcuYWN0aXZlUG9wb3ZlcnMoKS5zb21lKHBvcG92ZXIgPT4ge1xuICAgICAgICAgICAgaWYgKHBvcG92ZXIgIT09IHRoaXMgJiYgcG9wb3Zlci50YXJnZXRFbCAmJiB0aGlzLmhvdmVyRWwuY29udGFpbnMocG9wb3Zlci50YXJnZXRFbCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9wb3Zlci5zaG91bGRTaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3VsZFNob3dTZWxmKCkge1xuICAgICAgICAvLyBEb24ndCBsZXQgb2JzaWRpYW4gc2hvdygpIHVzIGlmIHdlJ3ZlIGFscmVhZHkgc3RhcnRlZCBjbG9zaW5nXG4gICAgICAgIC8vIHJldHVybiAhdGhpcy5kZXRhY2hpbmcgJiYgKHRoaXMub25UYXJnZXQgfHwgdGhpcy5vbkhvdmVyKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICF0aGlzLmRldGFjaGluZyAmJlxuICAgICAgICAgICAgISEoXG4gICAgICAgICAgICAgICAgdGhpcy5vblRhcmdldCB8fFxuICAgICAgICAgICAgICAgICh0aGlzLnN0YXRlID09IFBvcG92ZXJTdGF0ZS5TaG93bikgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGJvZHk+Lm1vZGFsLWNvbnRhaW5lciwgYm9keSA+ICNoZSR7dGhpcy5pZH0gfiAubWVudSwgYm9keSA+ICNoZSR7dGhpcy5pZH0gfiAuc3VnZ2VzdGlvbi1jb250YWluZXJgKVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHNob3coKSB7XG4gICAgICAgIC8vIG5hdGl2ZSBvYnNpZGlhbiBsb2dpYyBzdGFydFxuICAgICAgICAvLyBpZiAoIXRoaXMudGFyZ2V0RWwgfHwgdGhpcy5kb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMudGFyZ2V0RWwpKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gUG9wb3ZlclN0YXRlLlNob3duO1xuICAgICAgICAgICAgdGhpcy50aW1lciA9IDA7XG5cbiAgICAgICAgICAgIHRoaXMudGFyZ2V0RWwuYXBwZW5kQ2hpbGQodGhpcy5ob3ZlckVsKTtcbiAgICAgICAgICAgIHRoaXMub25TaG93KCk7XG4gICAgICAgICAgICBhcHAud29ya3NwYWNlLm9uTGF5b3V0Q2hhbmdlKCk7XG5cbiAgICAgICAgICAgIC8vIGluaXRpYWxpemluZ0hvdmVyUG9wb3ZlcnMucmVtb3ZlKHRoaXMpO1xuICAgICAgICAgICAgLy8gYWN0aXZlSG92ZXJQb3BvdmVycy5wdXNoKHRoaXMpO1xuICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZVBvcG92ZXJDaGVja2VyKCk7XG4gICAgICAgICAgICB0aGlzLmxvYWQoKTtcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyBuYXRpdmUgb2JzaWRpYW4gbG9naWMgZW5kXG5cbiAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBpbWFnZSB2aWV3LCBzZXQgdGhlIGRpbWVuc2lvbnMgdG8gdGhlIG5hdHVyYWwgZGltZW5zaW9ucyBvZiB0aGUgaW1hZ2VcbiAgICAgICAgLy8gYW4gaW50ZXJhY3RqcyByZWZsb3cgd2lsbCBiZSB0cmlnZ2VyZWQgdG8gY29uc3RyYWluIHRoZSBpbWFnZSB0byB0aGUgdmlld3BvcnQgaWYgaXQnc1xuICAgICAgICAvLyB0b28gbGFyZ2VcbiAgICAgICAgaWYgKHRoaXMuaG92ZXJFbC5kYXRhc2V0LmltZ0hlaWdodCAmJiB0aGlzLmhvdmVyRWwuZGF0YXNldC5pbWdXaWR0aCkge1xuICAgICAgICAgICAgdGhpcy5ob3ZlckVsLnN0eWxlLmhlaWdodCA9IHBhcnNlRmxvYXQodGhpcy5ob3ZlckVsLmRhdGFzZXQuaW1nSGVpZ2h0KSArIHRoaXMudGl0bGVFbC5vZmZzZXRIZWlnaHQgKyBcInB4XCI7XG4gICAgICAgICAgICB0aGlzLmhvdmVyRWwuc3R5bGUud2lkdGggPSBwYXJzZUZsb2F0KHRoaXMuaG92ZXJFbC5kYXRhc2V0LmltZ1dpZHRoKSArIFwicHhcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uSGlkZSgpIHtcbiAgICAgICAgdGhpcy5vbGRQb3BvdmVyID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50Py5ob3ZlclBvcG92ZXIgPT09IHRoaXMpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmhvdmVyUG9wb3ZlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoaWRlKCkge1xuICAgICAgICB0aGlzLm9uVGFyZ2V0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZGV0YWNoaW5nID0gdHJ1ZTtcbiAgICAgICAgLy8gT25jZSB3ZSByZWFjaCB0aGlzIHBvaW50LCB3ZSdyZSBjb21taXR0ZWQgdG8gY2xvc2luZ1xuXG4gICAgICAgIC8vIGluIGNhc2Ugd2UgZGlkbid0IGV2ZXIgY2FsbCBzaG93KClcblxuXG4gICAgICAgIC8vIEEgdGltZXIgbWlnaHQgYmUgcGVuZGluZyB0byBjYWxsIHNob3coKSBmb3IgdGhlIGZpcnN0IHRpbWUsIG1ha2Ugc3VyZVxuICAgICAgICAvLyBpdCBkb2Vzbid0IGJyaW5nIHVzIGJhY2sgdXAgYWZ0ZXIgd2UgY2xvc2VcbiAgICAgICAgaWYgKHRoaXMudGltZXIpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGlkZSBvdXIgSFRNTCBlbGVtZW50IGltbWVkaWF0ZWx5LCBldmVuIGlmIG91ciBsZWF2ZXMgbWlnaHQgbm90IGJlXG4gICAgICAgIC8vIGRldGFjaGFibGUgeWV0LiAgVGhpcyBtYWtlcyB0aGluZ3MgbW9yZSByZXNwb25zaXZlIGFuZCBpbXByb3ZlcyB0aGVcbiAgICAgICAgLy8gb2RkcyBvZiBub3Qgc2hvd2luZyBhbiBlbXB0eSBwb3B1cCB0aGF0J3MganVzdCBnb2luZyB0byBkaXNhcHBlYXJcbiAgICAgICAgLy8gbW9tZW50YXJpbHkuXG4gICAgICAgIHRoaXMuaG92ZXJFbC5oaWRlKCk7XG5cbiAgICAgICAgLy8gSWYgYSBmaWxlIGxvYWQgaXMgaW4gcHJvZ3Jlc3MsIHdlIG5lZWQgdG8gd2FpdCB1bnRpbCBpdCdzIGZpbmlzaGVkIGJlZm9yZVxuICAgICAgICAvLyBkZXRhY2hpbmcgbGVhdmVzLiAgQmVjYXVzZSB3ZSBzZXQgLmRldGFjaGluZywgVGhlIGluLXByb2dyZXNzIG9wZW5GaWxlKClcbiAgICAgICAgLy8gd2lsbCBjYWxsIHVzIGFnYWluIHdoZW4gaXQgZmluaXNoZXMuXG4gICAgICAgIGlmICh0aGlzLm9wZW5pbmcpIHJldHVybjtcblxuICAgICAgICAvLyBMZWF2ZSB0aGlzIGNvZGUgaGVyZSB0byBvYnNlcnZlIHRoZSBzdGF0ZSBvZiB0aGUgbGVhdmVzXG4gICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMubGVhdmVzKCk7XG4gICAgICAgIGlmIChsZWF2ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBEZXRhY2ggYWxsIGxlYXZlcyBiZWZvcmUgd2UgdW5sb2FkIHRoZSBwb3BvdmVyIGFuZCByZW1vdmUgaXQgZnJvbSB0aGUgRE9NLlxuICAgICAgICAgICAgLy8gRWFjaCBsZWFmLmRldGFjaCgpIHdpbGwgdHJpZ2dlciBsYXlvdXQtY2hhbmdlZCBhbmQgdGhlIHVwZGF0ZUxlYXZlcygpXG4gICAgICAgICAgICAvLyBtZXRob2Qgd2lsbCB0aGVuIGNhbGwgaGlkZSgpIGFnYWluIHdoZW4gdGhlIGxhc3Qgb25lIGlzIGdvbmUuXG4gICAgICAgICAgICAvLyBsZWF2ZXNbMF0uZGV0YWNoKCk7XG4gICAgICAgICAgICAvLyBsZWF2ZXNbMF0uZGV0YWNoKCk7XG4gICAgICAgICAgICB0aGlzLnRhcmdldEVsLmVtcHR5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmFib3J0Q29udHJvbGxlcj8udW5sb2FkKCk7XG4gICAgICAgICAgICB0aGlzLmFib3J0Q29udHJvbGxlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZUhpZGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5hdGl2ZUhpZGUoKSB7XG4gICAgICAgIGNvbnN0IHsgaG92ZXJFbCwgdGFyZ2V0RWwgfSA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBQb3BvdmVyU3RhdGUuSGlkZGVuO1xuICAgICAgICBob3ZlckVsLmRldGFjaCgpO1xuXG4gICAgICAgIGlmICh0YXJnZXRFbCkge1xuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gdGFyZ2V0RWwubWF0Y2hQYXJlbnQoXCIuZnMtbGVhZi12aWV3XCIpO1xuICAgICAgICAgICAgaWYgKHBhcmVudCkgcG9wb3ZlcnMuZ2V0KHBhcmVudCk/LnRyYW5zaXRpb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub25IaWRlKCk7XG4gICAgICAgIHRoaXMudW5sb2FkKCk7XG4gICAgfVxuXG4gICAgcmVzb2x2ZUxpbmsobGlua1RleHQ6IHN0cmluZywgc291cmNlUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgY29uc3QgbGluayA9IHBhcnNlTGlua3RleHQobGlua1RleHQpO1xuICAgICAgICBjb25zdCB0RmlsZSA9IGxpbmsgPyB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rLnBhdGgsIHNvdXJjZVBhdGgpIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIHRGaWxlO1xuICAgIH1cblxuICAgIGFzeW5jIG9wZW5MaW5rKGxpbmtUZXh0OiBzdHJpbmcsIHNvdXJjZVBhdGg6IHN0cmluZywgZVN0YXRlPzogRXBoZW1lcmFsU3RhdGUsIGNyZWF0ZUluTGVhZj86IFdvcmtzcGFjZUxlYWYpIHtcbiAgICAgICAgbGV0IGZpbGUgPSB0aGlzLnJlc29sdmVMaW5rKGxpbmtUZXh0LCBzb3VyY2VQYXRoKTtcbiAgICAgICAgY29uc3QgbGluayA9IHBhcnNlTGlua3RleHQobGlua1RleHQpO1xuICAgICAgICBpZiAoIWZpbGUgJiYgY3JlYXRlSW5MZWFmKSB7XG4gICAgICAgICAgICBjb25zdCBmb2xkZXIgPSB0aGlzLnBsdWdpbi5hcHAuZmlsZU1hbmFnZXIuZ2V0TmV3RmlsZVBhcmVudChzb3VyY2VQYXRoKTtcbiAgICAgICAgICAgIGZpbGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAuZmlsZU1hbmFnZXIuY3JlYXRlTmV3TWFya2Rvd25GaWxlKGZvbGRlciwgbGluay5wYXRoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgLy8gdGhpcy5kaXNwbGF5Q3JlYXRlRmlsZUFjdGlvbihsaW5rVGV4dCwgc291cmNlUGF0aCwgZVN0YXRlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IHZpZXdSZWdpc3RyeSB9ID0gdGhpcy5wbHVnaW4uYXBwO1xuICAgICAgICBjb25zdCB2aWV3VHlwZSA9IHZpZXdSZWdpc3RyeS50eXBlQnlFeHRlbnNpb25bZmlsZS5leHRlbnNpb25dO1xuICAgICAgICBpZiAoIXZpZXdUeXBlIHx8ICF2aWV3UmVnaXN0cnkudmlld0J5VHlwZVt2aWV3VHlwZV0pIHtcbiAgICAgICAgICAgIC8vIHRoaXMuZGlzcGxheU9wZW5GaWxlQWN0aW9uKGZpbGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZVN0YXRlID0gT2JqZWN0LmFzc2lnbih0aGlzLmJ1aWxkRXBoZW1lcmFsU3RhdGUoZmlsZSwgbGluayksIGVTdGF0ZSk7XG4gICAgICAgIGNvbnN0IHBhcmVudE1vZGUgPSB0aGlzLmdldERlZmF1bHRNb2RlKCk7XG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5idWlsZFN0YXRlKHBhcmVudE1vZGUsIGVTdGF0ZSk7XG4gICAgICAgIGNvbnN0IGxlYWYgPSBhd2FpdCB0aGlzLm9wZW5GaWxlKGZpbGUsIHN0YXRlLCBjcmVhdGVJbkxlYWYpO1xuICAgICAgICBjb25zdCBsZWFmVmlld1R5cGUgPSBsZWFmPy52aWV3Py5nZXRWaWV3VHlwZSgpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhsZWFmKTtcbiAgICAgICAgaWYgKGxlYWZWaWV3VHlwZSA9PT0gXCJpbWFnZVwiKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiB0ZW1wb3Jhcnkgd29ya2Fyb3VuZCB0byBwcmV2ZW50IGltYWdlIHBvcG92ZXIgZnJvbSBkaXNhcHBlYXJpbmcgaW1tZWRpYXRlbHkgd2hlbiB1c2luZyBsaXZlIHByZXZpZXdcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudD8uaGFzT3duUHJvcGVydHkoXCJlZGl0b3JFbFwiKSAmJlxuICAgICAgICAgICAgICAgICh0aGlzLnBhcmVudCBhcyB1bmtub3duIGFzIE1hcmtkb3duRWRpdFZpZXcpLmVkaXRvckVsIS5oYXNDbGFzcyhcImlzLWxpdmUtcHJldmlld1wiKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53YWl0VGltZSA9IDMwMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBpbWcgPSBsZWFmIS52aWV3LmNvbnRlbnRFbC5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpITtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJFbC5kYXRhc2V0LmltZ0hlaWdodCA9IFN0cmluZyhpbWcubmF0dXJhbEhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLmhvdmVyRWwuZGF0YXNldC5pbWdXaWR0aCA9IFN0cmluZyhpbWcubmF0dXJhbFdpZHRoKTtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJFbC5kYXRhc2V0LmltZ1JhdGlvID0gU3RyaW5nKGltZy5uYXR1cmFsV2lkdGggLyBpbWcubmF0dXJhbEhlaWdodCk7XG4gICAgICAgIH0gZWxzZSBpZiAobGVhZlZpZXdUeXBlID09PSBcInBkZlwiKSB7XG4gICAgICAgICAgICB0aGlzLmhvdmVyRWwuc3R5bGUuaGVpZ2h0ID0gXCI4MDBweFwiO1xuICAgICAgICAgICAgdGhpcy5ob3ZlckVsLnN0eWxlLndpZHRoID0gXCI2MDBweFwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGF0ZS5zdGF0ZT8ubW9kZSA9PT0gXCJzb3VyY2VcIikge1xuICAgICAgICAgICAgdGhpcy53aGVuU2hvd24oKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIE5vdCBzdXJlIHdoeSB0aGlzIGlzIG5lZWRlZCwgYnV0IHdpdGhvdXQgaXQgd2UgZ2V0IGlzc3VlICMxODZcbiAgICAgICAgICAgICAgICBpZiAocmVxdWlyZUFwaVZlcnNpb24oXCIxLjBcIikpKGxlYWY/LnZpZXcgYXMgYW55KT8uZWRpdE1vZGU/LnJlaW5pdD8uKCk7XG4gICAgICAgICAgICAgICAgbGVhZj8udmlldz8uc2V0RXBoZW1lcmFsU3RhdGUoc3RhdGUuZVN0YXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgd2hlblNob3duKGNhbGxiYWNrOiAoKSA9PiBhbnkpIHtcbiAgICAgICAgLy8gaW52b2tlIGNhbGxiYWNrIG9uY2UgdGhlIHBvcG92ZXIgaXMgdmlzaWJsZVxuICAgICAgICBpZiAodGhpcy5kZXRhY2hpbmcpIHJldHVybjtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdDYWxsYmFjayA9IHRoaXMub25TaG93Q2FsbGJhY2s7XG4gICAgICAgIHRoaXMub25TaG93Q2FsbGJhY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5kZXRhY2hpbmcpIHJldHVybjtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGV4aXN0aW5nQ2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikgZXhpc3RpbmdDYWxsYmFjaygpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gUG9wb3ZlclN0YXRlLlNob3duKSB7XG4gICAgICAgICAgICB0aGlzLm9uU2hvd0NhbGxiYWNrKCk7XG4gICAgICAgICAgICB0aGlzLm9uU2hvd0NhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgb3BlbkZpbGUoZmlsZTogVEZpbGUsIG9wZW5TdGF0ZT86IE9wZW5WaWV3U3RhdGUsIHVzZUxlYWY/OiBXb3Jrc3BhY2VMZWFmKSB7XG4gICAgICAgIGlmICh0aGlzLmRldGFjaGluZykgcmV0dXJuO1xuICAgICAgICBjb25zdCBsZWFmID0gdXNlTGVhZiA/PyB0aGlzLmF0dGFjaExlYWYoKTtcbiAgICAgICAgdGhpcy5vcGVuaW5nID0gdHJ1ZTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlLCBvcGVuU3RhdGUpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5vcGVuaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5kZXRhY2hpbmcpIHRoaXMuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihsZWFmKTtcblxuICAgICAgICByZXR1cm4gbGVhZjtcbiAgICB9XG5cbiAgICBidWlsZFN0YXRlKHBhcmVudE1vZGU6IHN0cmluZywgZVN0YXRlPzogRXBoZW1lcmFsU3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFjdGl2ZTogZmFsc2UsIC8vIERvbid0IGxldCBPYnNpZGlhbiBmb3JjZSBmb2N1cyBpZiB3ZSBoYXZlIGF1dG9mb2N1cyBvZmZcbiAgICAgICAgICAgIHN0YXRlOiB7IG1vZGU6IFwic291cmNlXCIgfSwgLy8gRG9uJ3Qgc2V0IGFueSBzdGF0ZSBmb3IgdGhlIHZpZXcsIGJlY2F1c2UgdGhpcyBsZWFmIGlzIHN0YXllZCBvbiBhbm90aGVyIHZpZXcuXG4gICAgICAgICAgICBlU3RhdGU6IGVTdGF0ZSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBidWlsZEVwaGVtZXJhbFN0YXRlKFxuICAgICAgICBmaWxlOiBURmlsZSxcbiAgICAgICAgbGluaz86IHtcbiAgICAgICAgICAgIHBhdGg6IHN0cmluZztcbiAgICAgICAgICAgIHN1YnBhdGg6IHN0cmluZztcbiAgICAgICAgfSxcbiAgICApIHtcbiAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgIGNvbnN0IHN1YnBhdGggPSBjYWNoZSA/IHJlc29sdmVTdWJwYXRoKGNhY2hlLCBsaW5rPy5zdWJwYXRoIHx8IFwiXCIpIDogdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBlU3RhdGU6IEVwaGVtZXJhbFN0YXRlID0geyBzdWJwYXRoOiBsaW5rPy5zdWJwYXRoIH07XG4gICAgICAgIGlmIChzdWJwYXRoKSB7XG4gICAgICAgICAgICBlU3RhdGUubGluZSA9IHN1YnBhdGguc3RhcnQubGluZTtcbiAgICAgICAgICAgIGVTdGF0ZS5zdGFydExvYyA9IHN1YnBhdGguc3RhcnQ7XG4gICAgICAgICAgICBlU3RhdGUuZW5kTG9jID0gc3VicGF0aC5lbmQgfHwgdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlU3RhdGU7XG4gICAgfVxufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBhcm91bmQob2JqLCBmYWN0b3JpZXMpIHtcbiAgICBjb25zdCByZW1vdmVycyA9IE9iamVjdC5rZXlzKGZhY3RvcmllcykubWFwKGtleSA9PiBhcm91bmQxKG9iaiwga2V5LCBmYWN0b3JpZXNba2V5XSkpO1xuICAgIHJldHVybiByZW1vdmVycy5sZW5ndGggPT09IDEgPyByZW1vdmVyc1swXSA6IGZ1bmN0aW9uICgpIHsgcmVtb3ZlcnMuZm9yRWFjaChyID0+IHIoKSk7IH07XG59XG5mdW5jdGlvbiBhcm91bmQxKG9iaiwgbWV0aG9kLCBjcmVhdGVXcmFwcGVyKSB7XG4gICAgY29uc3Qgb3JpZ2luYWwgPSBvYmpbbWV0aG9kXSwgaGFkT3duID0gb2JqLmhhc093blByb3BlcnR5KG1ldGhvZCk7XG4gICAgbGV0IGN1cnJlbnQgPSBjcmVhdGVXcmFwcGVyKG9yaWdpbmFsKTtcbiAgICAvLyBMZXQgb3VyIHdyYXBwZXIgaW5oZXJpdCBzdGF0aWMgcHJvcHMgZnJvbSB0aGUgd3JhcHBpbmcgbWV0aG9kLFxuICAgIC8vIGFuZCB0aGUgd3JhcHBpbmcgbWV0aG9kLCBwcm9wcyBmcm9tIHRoZSBvcmlnaW5hbCBtZXRob2RcbiAgICBpZiAob3JpZ2luYWwpXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihjdXJyZW50LCBvcmlnaW5hbCk7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIGN1cnJlbnQpO1xuICAgIG9ialttZXRob2RdID0gd3JhcHBlcjtcbiAgICAvLyBSZXR1cm4gYSBjYWxsYmFjayB0byBhbGxvdyBzYWZlIHJlbW92YWxcbiAgICByZXR1cm4gcmVtb3ZlO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICAvLyBJZiB3ZSBoYXZlIGJlZW4gZGVhY3RpdmF0ZWQgYW5kIGFyZSBubyBsb25nZXIgd3JhcHBlZCwgcmVtb3ZlIG91cnNlbHZlc1xuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwgJiYgb2JqW21ldGhvZF0gPT09IHdyYXBwZXIpXG4gICAgICAgICAgICByZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgICAgLy8gSWYgbm8gb3RoZXIgcGF0Y2hlcywganVzdCBkbyBhIGRpcmVjdCByZW1vdmFsXG4gICAgICAgIGlmIChvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcikge1xuICAgICAgICAgICAgaWYgKGhhZE93bilcbiAgICAgICAgICAgICAgICBvYmpbbWV0aG9kXSA9IG9yaWdpbmFsO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBvYmpbbWV0aG9kXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIC8vIEVsc2UgcGFzcyBmdXR1cmUgY2FsbHMgdGhyb3VnaCwgYW5kIHJlbW92ZSB3cmFwcGVyIGZyb20gdGhlIHByb3RvdHlwZSBjaGFpblxuICAgICAgICBjdXJyZW50ID0gb3JpZ2luYWw7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih3cmFwcGVyLCBvcmlnaW5hbCB8fCBGdW5jdGlvbik7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGRlZHVwZShrZXksIG9sZEZuLCBuZXdGbikge1xuICAgIGNoZWNrW2tleV0gPSBrZXk7XG4gICAgcmV0dXJuIGNoZWNrO1xuICAgIGZ1bmN0aW9uIGNoZWNrKC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIChvbGRGbltrZXldID09PSBrZXkgPyBvbGRGbiA6IG5ld0ZuKS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gYWZ0ZXIocHJvbWlzZSwgY2IpIHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGNiLCBjYik7XG59XG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplKGFzeW5jRnVuY3Rpb24pIHtcbiAgICBsZXQgbGFzdFJ1biA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gbGFzdFJ1biA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAgICAgYWZ0ZXIobGFzdFJ1biwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzeW5jRnVuY3Rpb24uYXBwbHkodGhpcywgYXJncykudGhlbihyZXMsIHJlaik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHdyYXBwZXIuYWZ0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7IGFmdGVyKGxhc3RSdW4sIHJlcyk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIHdyYXBwZXI7XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBWU87OztBQ1JQLHNCQWVPO0FBV1AsSUFBTSxXQUFXLG9CQUFJLFFBQStCO0FBRzdDLHlCQUF5QixNQUFxQjtBQUVqRCxTQUFPLEtBQUssWUFBWSxRQUFRLHdDQUF3QztBQUM1RTtBQUVBLGVBQWUsTUFBc0I7QUFDakMsUUFBTSxRQUFRLENBQUM7QUFDZixXQUFTLElBQUksR0FBRyxJQUFJLE1BQU07QUFBSyxVQUFNLEtBQU8sTUFBSyxLQUFLLE9BQU8sSUFBSyxHQUFHLFNBQVMsRUFBRSxDQUFDO0FBQ2pGLFNBQU8sTUFBTSxLQUFLLEVBQUU7QUFDeEI7QUFFQSxpQkFBb0IsTUFBa0Q7QUFDbEUsUUFBTSxV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QVU7QUFDakIsWUFBTSxLQUFLLFNBQVMsU0FBUyxNQUFNO0FBQUEsUUFDbEMsUUFBUTtBQUFBLFFBQ1IsUUFBUTtBQUFBLE1BQ1QsQ0FBQztBQUVELFVBQUcsb0JBQUssY0FBTCxvQkFBZ0IsVUFBaEIsb0JBQXVCLFFBQVEsUUFBTyx1Q0FBTyxVQUFQLG9CQUFjLFFBQVEsT0FBTSxTQUFTLEtBQUssV0FBVztBQUM3RixtQkFBVyxNQUFJO0FBQ2QsY0FBRyxLQUFLLFVBQVU7QUFDakIsZ0JBQUksVUFBVSxjQUFjLEtBQUssVUFBVTtBQUFBLGNBQzFDLE9BQU87QUFBQSxZQUNSLENBQUM7QUFBQSxVQUNGO0FBQUEsUUFDRCxHQUFHLENBQUM7QUFBQSxNQUNMLE9BQU87QUFDTixhQUFLLFlBQVk7QUFDakIsbUJBQVcsTUFBTTtBQUNoQixVQUFDLEtBQUssV0FBVyxLQUFvQixnQkFBZ0IsUUFBUSxNQUFNO0FBQUEsUUFDcEUsR0FBRyxDQUFDO0FBQUEsTUFDTDtBQUVBO0FBQUEsSUFDRDtBQUVBLFVBQU0sRUFBRSxjQUFjO0FBQ3RCLFNBQUssU0FBUyxVQUFVLFVBQVUsRUFBRSxLQUFLLDhCQUE4QixDQUFDO0FBQ3hFLFNBQUssUUFBUSxZQUFZLHNCQUFzQixJQUFJO0FBQ25ELFNBQUssT0FBTyxZQUFZLENBQUMsTUFBTTtBQUM5QixVQUFHLEVBQUUsV0FBVyxFQUFFLFFBQVEsS0FBSztBQUM5QixVQUFFLGVBQWU7QUFDakIsVUFBRSxnQkFBZ0I7QUFFbEIsUUFBQyxLQUFLLFdBQVcsS0FBb0IsZ0JBQWdCLFFBQVEsTUFBTTtBQUFBLE1BQ3BFO0FBRUEsVUFBRyxFQUFFLFFBQVEsU0FBUyxFQUFFLFNBQVM7QUFDaEMsVUFBRSxlQUFlO0FBQ2pCLFVBQUUsZ0JBQWdCO0FBRWxCLFFBQUMsS0FBSyxXQUFXLEtBQW9CLGdCQUFnQixRQUFRLE1BQU07QUFBQSxNQUNwRTtBQUFBLElBQ0Q7QUFFQSxRQUFHLENBQUMsS0FBSztBQUFRO0FBRWpCLFVBQU0sQ0FBQyxhQUFhLGdCQUFnQixjQUFjLEtBQUssUUFBUSxLQUFLLE1BQU07QUFDMUUsU0FBSyxXQUFXO0FBQ2hCLFNBQUssbUJBQW1CO0FBRXhCLFNBQUssU0FBUyxVQUFVLElBQUk7QUFDNUIsVUFBTSxLQUFLLFNBQVMsU0FBUyxNQUFNO0FBQUEsTUFDbEMsUUFBUTtBQUFBLE1BQ1IsUUFBUTtBQUFBLElBQ1QsQ0FBQztBQUNELFNBQUssWUFBWTtBQUVqQixJQUFDLEtBQUssV0FBVyxLQUFvQixnQkFBZ0IsUUFBUSxNQUFNO0FBQUEsRUFFcEU7QUFDRDsiLAogICJuYW1lcyI6IFtdCn0K
